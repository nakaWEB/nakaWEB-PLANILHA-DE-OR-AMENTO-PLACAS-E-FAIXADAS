<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLACAS E FAIXADAS</title>

      <link rel="icon" href="favicon.ico" type="image/x-icon">
      <link rel="icon" type="image/png" href="favicon.png">
      <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* >.< BODY*/

        /* Para navegadores baseados em WebKit (Chrome, Safari) */
        body::-webkit-scrollbar {
            display: none;
        }

        /* Firefox */
        body {
            scrollbar-width: none;
            /* Oculta a barra de rolagem */
        }

        /* Chrome, Safari, Edge (estiliza a barra como invisível) */
        body {
            -ms-overflow-style: none;
            /* IE/Edge */
            overflow: -moz-scrollbars-none;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--text-color);
            line-height: 1.6;
            padding-top: 70px;
            padding-bottom: 90px;
            transition: var(--transition);
        }

        /* >.< TEMAS VARIAVEIS*/
        /* ======= VARIÁVEIS CSS PARA TEMA ======= */
        :root {
            --traparente-color: #ffffff00;
            --primary-color: #0055b1;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --dark-color: #343a40;
            --light-color: #f8f9fa;
            --bg-color: #f5f7fa;
            --text-color: #333;
            --border-color: #dee2e6;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 4px 20px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --border-radius: 8px;
            --border-radius-lg: 12px;
        }

        /* ======= ESTILOS GLOBAIS ======= */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        /* >.< HTML*/
        html {
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--light-color);
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--light-color);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        /* >.< SITE*/
        /* >.< BARRA TOPO*/
        .barratopo {
            background: rgb(255, 255, 255);
            position: fixed;
            top: 0;
            left: 24%;
            width: 76%;
            height: 60px;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
        }

        .github-info {
            position: fixed;
            top: 10px;
            left: 62%;
            transform: translateX(-50%);
            background: rgba(36, 41, 46, 0.9);
            color: rgb(255, 255, 255);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            z-index: 1002;
            backdrop-filter: blur(10px);
            border: 1px solid rgb(255, 255, 255);
            animation: githubInfo 4s linear;
        }

        @keyframes fadeInDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* >.< PANEL ADMIN*/
        .admin-panel {
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgb(218, 218, 218);
            padding: 20px;
            z-index: 1001;
            width: 24%;
            overflow-y: auto;
            transition: var(--transition);
        }

        .admin-panel h4 {
            margin: 0 0 10px 0;
            color: rgb(0, 0, 0);
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .admin-panel button {
            width: 100%;
            margin: 8px 0;
            padding: 12px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .admin-panel button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-primary {
            background: rgb(255, 255, 255);
            color: rgb(0, 0, 0);
            border: 2px solid rgb(0, 0, 0);
        }

        .btn-success {
            background: rgb(255, 255, 255);
            color: rgb(0, 0, 0);
        }

        .btn-info {
            background: rgb(255, 255, 255);
            color: rgb(0, 0, 0);
        }

        .btn-warning {
            background: white;
            color: rgb(0, 0, 0);
        }

        .btn-danger {
            background: white;
            color: rgb(0, 0, 0);
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 999;
        }

        .action-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 10px;
            cursor: pointer;
            font-size: 18px;
            color: white;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-button:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: var(--shadow-lg);
        }

        .btn-save {
            background: #ffffff;
            color: rgb(0, 0, 0);
        }

        .btn-load {
            background: #ffffff;
            color: rgb(0, 0, 0);
        }

        .btn-theme {
            background: #ffffff;
            color: black;
        }

        /* >.< IMPUTS PAINEL ADMIN*/
        .admin-panel input,
        .admin-panel select {
            width: 100%;
            padding: 10px;
            margin: 8px 0;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 13px;
            transition: var(--transition);
            background: var(--light-color);
        }

        .admin-panel input:focus,
        .admin-panel select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
        }

        /* >.< PLANILHAS*/
        .planilha {
            width: calc(100% - 320px);
            margin-left: 300px;
            border-collapse: collapse;
            background: rgb(241, 241, 241);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-lg);
            border-radius: 10px;
            overflow: hidden;
            transition: var(--transition);
        }

        .planilha thead {
            background: #000000;
            color: white;
            position: sticky;
            top: 0px;
            z-index: 10;
        }

        .planilha th,
        .planilha td {
            border: 1px solid var(--border-color);
            padding: 4px;
            text-align: left;
            transition: var(--transition);
        }

        .planilha tbody tr {
            transition: var(--transition);
        }

        .planilha tbody tr:nth-child(even) {
            background: rgba(0, 0, 0, 0.02);
        }

        .planilha tbody tr:hover {
            background: rgba(0, 0, 0, 0.1);
            transform: scale(1.01);
        }

        .info-extra td {
            background: linear-gradient(45deg, #fff2c7, #ffeaa7);
            font-weight: bold;
            color: var(--dark-color);
        }

        /* >.< BOTÃO CLONAR*/
        .col-clonar {
            width: 40px;
            text-align: center;
        }

        .btn-clone {
            background: #000000;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            margin: 0 auto;
        }

        .btn-clone:hover {
            background: rgba(0, 0, 0, 0.315);
            transform: scale(1.1) rotate(360deg);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        /* >.< INPUTS*/
        input[type="number"],
        input[type="text"] {
            width: 100%;
            padding: 8px 12px;
            font-size: 14px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            background: var(--light-color);
            color: var(--text-color);
            transition: var(--transition);
        }

        input[type="number"]:focus,
        input[type="text"]:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
            background: white;
        }

        .valor-total {
            font-weight: bold;
            color: var(--success-color);
            font-size: 15px;
        }


        /* >.< NAVEGAÇÃO*/
        .pagina {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            animation: fadeIn 0.5s ease-out;
        }

        .pagina.ativa {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* >.< BARRA INFERIOR*/
        .barra-inferior {
            position: fixed;
            bottom: 0;
            left: 24%;
            width: 76%;
            height: 10%;
            background: rgb(255, 255, 255);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            padding: 10px;
            z-index: 1000;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .barra-inferior button {
            background: rgb(0, 0, 0);
            color: rgb(255, 255, 255);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 3px 12px;
            margin: 2px;
            cursor: pointer;
            border-radius: 25px;
            font-size: 13px;
            font-weight: 500;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .barra-inferior button:hover {
            background: rgba(0, 0, 0, 0.548);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .barra-inferior button.ativo {
            background: #000000af;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.39);
        }

        /* >.< MODAIS*/
        .modal {
            display: none;
            position: fixed;
            z-index: 1003;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-content {
            background: linear-gradient(135deg, var(--light-color) 0%, white 100%);
            margin: 5% auto;
            padding: 30px;
            border-radius: var(--border-radius-lg);
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }



        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-header h3 {
            margin: 0;
            color: var(--primary-color);
            font-size: 1.5rem;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }

        .close:hover {
            color: var(--danger-color);
            transform: rotate(90deg);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 14px;
            transition: var(--transition);
            background: var(--light-color);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
        }

        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .btn-group button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-group button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* ======= NOTIFICAÇÕES ======= */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: var(--border-radius);
            color: white;
            font-weight: 600;
            z-index: 1002;
            transform: translateX(400px);
            transition: var(--transition);
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: #51ff00;
        }

        .notification.error {
            background: #ff001e;
        }

        .notification.warning {
            background: #f093fb;
            color: white;
        }

        .notification.info {
            background: #4facfe;
        }

        /* ======= NOTIFICAÇÕES ======= */
        .notif {
            position: fixed;
            top: 20px;
            right: 20px;
            min-width: 300px;
            max-width: 400px;
            padding: 16px 20px;
            border-radius: 8px;
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 9999;
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .notif--show {
            transform: translateX(0);
            opacity: 1;
        }

        /* ======= TIPOS DE NOTIFICAÇÕES ======= */
        .notif--info {
            background: linear-gradient(135deg, #3498db, #2980b9);
            border-left: 4px solid #1f5f8b;
        }

        .notif--success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            border-left: 4px solid #1e8449;
        }

        .notif--warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            border-left: 4px solid #d35400;
            color: #2c3e50;
        }

        .notif--error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            border-left: 4px solid #922b21;
        }

        /* ======= ÍCONES ======= */
        .notif::before {
            font-size: 20px;
            font-weight: bold;
            flex-shrink: 0;
        }

        .notif--info::before {
            content: "ℹ";
        }

        .notif--success::before {
            content: "✓";
        }

        .notif--warning::before {
            content: "⚠";
        }

        .notif--error::before {
            content: "✕";
        }

        /* ======= BOTÃO FECHAR ======= */
        .notif__close {
            margin-left: auto;
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            opacity: 0.7;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: opacity 0.2s;
        }

        .notif__close:hover {
            opacity: 1;
            background: rgba(255, 255, 255, 0.2);
        }

        /* ======= RESPONSIVO ======= */
        @media (max-width: 480px) {
            .notif {
                top: 10px;
                right: 10px;
                left: 10px;
                min-width: auto;
                max-width: none;
            }
        }

        /* ======= ANIMAÇÃO DE PULSO PARA ERROS ======= */
        @keyframes notif-pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(231, 76, 60, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(231, 76, 60, 0);
            }
        }

        .notif--error.notif--show {
            animation: notif-pulse 1.5s ease-out;
        }

        /* ======= RESPONSIVO ======= */
        .admin-panel {
            position: fixed;
            top: 0%;
            left: 0%;
            width: 24%;
        }

        @media (max-width: 768px) {
            .admin-panel {
                margin: 20px;
                width: calc(100% - 40px);
                max-height: none;
            }

            .planilha {
                width: 100%;
                margin: 20px 0;
                font-size: 12px;
            }

            .planilha th,
            .planilha td {
                padding: 8px;
            }

            .action-buttons {
                position: fixed;
                bottom: 100px;
                right: 20px;
                top: auto;
                transform: none;
                flex-direction: row;
            }

            .barra-inferior {
                height: auto;
                padding: 15px;
            }

            .barra-inferior button {
                padding: 10px 15px;
                font-size: 12px;
            }
        }

        /* ======= LOADING ======= */
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* ======= UTILITÁRIOS ======= */
        .clicavel {
            cursor: pointer;
            transition: var(--transition);
            border-radius: var(--border-radius);
            padding: 8px;
            text-align: center;
        }

        .clicavel:hover {
            background: rgba(0, 123, 255, 0.1);
            transform: scale(1.05);
        }

        .hidden {
            display: none !important;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .slide-in {
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-100%);
            }

            to {
                transform: translateX(0);
            }
        }

        /* >.< NOTIFICAÇÕES DE VALORES*/
        /* Flutuante REBITES */
        .rebites-box {
            display: none;
            position: fixed;
            top: 4.5%;
            transform: translate(-50%, -50%);
            right: 130px;

            width: 80px;
            height: 50px;
            background: linear-gradient(45deg, #ff0000, #ff9999);
            color: #fff;
            padding: 10px 10px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            font-family: 'Segoe UI', sans-serif;
            z-index: 9999;
            min-width: 50px;
            text-align: center;
        }

        .rebites-titulo {
            font-weight: bold;
            font-size: 11px;
            margin-bottom: 4px;
        }

        .rebites-valor {
            font-size: 10px;
            font-weight: bold;
        }

        /* Flutuante ELETRODOS */
        .eletrodos-box {
            display: none;
            position: fixed;
            top: 4.5%;
            transform: translate(-50%, -50%);
            right: 30px;

            width: 80px;
            height: 50px;
            background: linear-gradient(45deg, #ff0000, #ff9999);
            color: #fff;
            padding: 10px 10px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            font-family: 'Segoe UI', sans-serif;
            z-index: 9999;
            min-width: 50px;
            text-align: center;
        }

        .eletrodos-titulo {
            font-weight: bold;
            font-size: 11px;
            margin-bottom: 4px;
        }

        .eletrodos-valor {
            font-size: 10px;
            font-weight: bold;
        }

        /*tempode produção estrada flutuante*/
        .tempo-pp-box {
            display: none;
            position: fixed;
            top: 4.5%;
            transform: translate(-50%, -50%);
            right: 30px;
            width: 125px;
            height: 50px;
            background: linear-gradient(45deg, #ff0000, #ff9999);
            color: #fff;
            padding: 10px 10px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            font-family: 'Segoe UI', sans-serif;
            z-index: 9999;
            min-width: 50px;
            text-align: center;
        }

        .tempo-pp-titulo {
            font-weight: bold;
            font-size: 10px;
            margin-bottom: 4px;
        }

        .tempo-pp-valor {
            font-size: 10px;
            font-weight: bold;
        }

        /*info cliente flutuante*/
        .info-cliente-box {
            display: none;
            position: fixed;
            top: 4.5%;
            transform: translate(-50%, -50%);
            right: 30px;
            width: 125px;
            height: 50px;
            background: linear-gradient(45deg, #ff0000, #ff9999);
            color: #fff;
            padding: 10px 10px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            font-family: 'Segoe UI', sans-serif;
            z-index: 9999;
            min-width: 50px;
            text-align: center;
        }

        .info-cliente-titulo {
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 2px;
        }

        .info-cliente-valor {
            font-size: 12px;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <!-- Helper para IndexedDB (1 kB) -->
    <script src="https://cdn.jsdelivr.net/npm/idb-keyval@6/dist/umd.js"></script>
    <!-- bibliotecas necessárias -->
    <script src="https://cdn.jsdelivr.net/npm/exceljs@4/dist/exceljs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2/dist/FileSaver.min.js"></script>

    <!-- script com a função -->
    <script src="seu-arquivo-com-a-funcao.js"></script>

    <!-- Input oculto para importar Excel -->
    <input type="file" id="importExcelInput" accept=".xlsx" style="display: none;"
        onchange="importarExcelOtimizado(this.files[0])">

    <!-- Loading -->
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
    </div>

    <!-- GitHub Pages Info -->
    <div class="github-info">
        <i class="fab fa-github"></i> Versão GitHub Pages
    </div>

    <!-- Admin Panel -->
    <div class="admin-panel">
        <h4><i class="fas fa-cog"></i> Gerenciar Produtos</h4>
        <button class="btn-primary" onclick="showAddProductModal()">
            <i class="fas fa-plus"></i> Adicionar Produto
        </button>
        <button class="btn-success" onclick="showImportModal()">
            <i class="fas fa-upload"></i> Importar CSV
        </button>
        <button class="btn-info" onclick="exportProducts()">
            <i class="fas fa-download"></i> Exportar CSV
        </button>
        <button class="btn-warning" onclick="resetProducts()">
            <i class="fas fa-undo"></i> Resetar Produtos
        </button>

        <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid var(--border-color);">
            <label style="font-size: 12px; font-weight: bold; display: block; margin-bottom: 5px;">
                <i class="fas fa-filter"></i> Categoria:
            </label>
            <select id="categoryFilter" onchange="filterByCategory()" style="margin-bottom: 10px;">
                <option value="">Todas</option>
            </select>

            <label style="font-size: 12px; font-weight: bold; display: block; margin-bottom: 5px;">
                <i class="fas fa-search"></i> Buscar:
            </label>
<input type="text" id="searchInput" placeholder="Buscar produto (nome)..." onkeyup="searchProducts()" style="margin-bottom: 15px;">
        </div>

        <div
            style="position: relative; top: -4%; transform: translate(0%, 50%); display: flex; justify-content: flex-end; align-items: center; gap: 5px;">
            <button style="height: 20px; width: 49%; justify-content: center;" class="btn-success"
                onclick="exportarExcelCompleto()">
                <i class="fas fa-file-excel"></i>
            </button>

            <button style="height: 20px; width: 49%;" class="action-button btn-load"
                onclick="document.getElementById('importExcelInput').click()" title="Carregar Orçamento">
                <i class="fas fa-folder-open"></i>
            </button>
        </div>

        <button style="height: 20px; width: 100%; justify-content: center;" class="btn-info"
            onclick="imprimirExcelCompleto()">
            <i class="fas fa-print"></i> IMPRIMIR
        </button>

<button style="height: 20px; width: 100%; justify-content: center;" class="btn-success" onclick="showCalculatorModal()" style="margin-top: 10px;">
    <i class="fas fa-calculator"></i> Calculadora
</button>

<button
  id="btnInstrucoes"
  type="button"
  style="font-size: 18px; position: relative; left: 50%; transform: translateX(-50%); height: 50px; width: 100%; justify-content: center;"
  title="instruções">
  instruções
</button>
    </div>
    </div>

    <div class="barratopo"></div>

    <div id="paginas-container"></div>
    <div class="barra-inferior" id="barra-inferior"></div>

    <!-- Add Product Modal -->
    <div id="addProductModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> Adicionar Novo Produto</h3>
                <span class="close" onclick="closeModal('addProductModal')">&times;</span>
            </div>
            <div class="form-group">
                <label for="productCode"><i class="fas fa-barcode"></i> Código:</label>
                <input type="text" id="productCode" required placeholder="Digite o código do produto">
            </div>
            <div class="form-group">
                <label for="productName"><i class="fas fa-tag"></i> Nome:</label>
                <input type="text" id="productName" required placeholder="Digite o nome do produto">
            </div>
            <div class="form-group">
                <label for="productCategory"><i class="fas fa-folder"></i> Categoria:</label>
                <select id="productCategory">
                    <option value="ESTRUTURA METALICA">ESTRUTURA METALICA</option>
                    <option value="LONAS E ADESIVOS">LONAS E ADESIVOS</option>
                    <option value="ACM FUNDO">ACM FUNDO</option>
                    <option value="PVC">PVC</option>
                    <option value="ILUMINAÇÃO">ILUMINAÇÃO</option>
                    <option value="MDF">MDF</option>
                    <option value="PINTURA">PINTURA</option>
                    <option value="MÃO DE OBRA">MÃO DE OBRA</option>
                </select>
            </div>
            <div class="form-group">
                <label for="productPrice"><i class="fas fa-dollar-sign"></i> Preço:</label>
                <input type="number" id="productPrice" step="0.01" required placeholder="0.00">
            </div>
            <div class="form-group">
                <label for="productUnit"><i class="fas fa-ruler"></i> Unidade:</label>
                <input type="text" id="productUnit" value="UNID" placeholder="UNID, M, M², etc.">
            </div>
            <div class="form-group">
                <label for="productFormula"><i class="fas fa-calculator"></i> Fórmula:</label>
                <input type="text" id="productFormula" value="Q * $" placeholder="Q * $, C * A * Q * $, etc.">
                <small>Use: Q=Quantidade, $=Preço, C=Comprimento, A=Largura</small>
            </div>
            <div class="btn-group">
                <button class="btn-primary" onclick="addProduct()">
                    <i class="fas fa-check"></i> Adicionar
                </button>
                <button class="btn-warning" onclick="closeModal('addProductModal')">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Import Modal -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-file-import"></i> Importar Produtos (CSV)</h3>
                <span class="close" onclick="closeModal('importModal')">&times;</span>
            </div>
            <div class="form-group">
                <label for="csvFile"><i class="fas fa-file-csv"></i> Arquivo CSV:</label>
                <input type="file" id="csvFile" accept=".csv" onchange="handleFileSelect(event)">
                <small>O arquivo deve conter: código, nome, preco, formula, unidade, categoria</small>
            </div>
            <div class="form-group">
                <label><i class="fas fa-paste"></i> Ou cole o conteúdo CSV:</label>
                <textarea id="csvContent" rows="10" style="width: 100%; font-family: monospace; resize: vertical;"
                    placeholder="codigo,nome,preco,formula,unidade,categoria
PROD001,Produto Exemplo,10.50,Q * $,UNID,ESTRUTURA METALICA"></textarea>
            </div>
            <div class="btn-group">
                <button class="btn-success" onclick="importFromText()">
                    <i class="fas fa-upload"></i> Importar
                </button>
                <button class="btn-warning" onclick="closeModal('importModal')">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Calculadora Modal -->
    <div id="calculatorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-calculator"></i> Calculadora</h3>
                <span class="close" onclick="closeModal('calculatorModal')">&times;</span>
            </div>
            <div class="form-group">
                <label>Display:</label>
                <input type="text" id="calcDisplay" readonly style="text-align: right; font-size: 18px;">
            </div>
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">
                <button onclick="calcClear()" class="btn-warning">C</button>
                <button onclick="calcAppend('/')" class="btn-info">/</button>
                <button onclick="calcAppend('*')" class="btn-info">*</button>
                <button onclick="calcDelete()" class="btn-danger">⌫</button>

                <button onclick="calcAppend('7')">7</button>
                <button onclick="calcAppend('8')">8</button>
                <button onclick="calcAppend('9')">9</button>
                <button onclick="calcAppend('-')" class="btn-info">-</button>

                <button onclick="calcAppend('4')">4</button>
                <button onclick="calcAppend('5')">5</button>
                <button onclick="calcAppend('6')">6</button>
                <button onclick="calcAppend('+')" class="btn-info">+</button>

                <button onclick="calcAppend('1')">1</button>
                <button onclick="calcAppend('2')">2</button>
                <button onclick="calcAppend('3')">3</button>
                <button onclick="calcCalculate()" class="btn-success" style="grid-row: span 2;">=</button>

                <button onclick="calcAppend('0')" style="grid-column: span 2;">0</button>
                <button onclick="calcAppend('.')">.</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>



    <script>
        // ======= VARIÁVEIS GLOBAIS =======
        const nomesPaginas = [
            "CLIENTE", "ESTRUTURA METALICA", "LONAS E ADESIVOS",
            "ACM FUNDO", "PVC", "ILUMINAÇÃO", "MDF",
            "PINTURA", "MÃO DE OBRA", "TOTAL GERAL", "ORÇAMENTO"
        ];

        let bibliotecaOrcamentos = JSON.parse(localStorage.getItem('bibliotecaOrcamentos')) || [];
        let currentProductId = 1000;
        let isDarkTheme = localStorage.getItem('darkTheme') === 'true';

        // ❌ FALTAVA: Definição do objeto catalogoProdutos
        let catalogoProdutos = {
            "ESTRUTURA METALICA": [
                { codigo: "43326", nome: "BARRA ACHATADA BRANCA 3FUROS 3/8X1/8", preco: 5, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601219", nome: "BARRA CHATA 1'X1/8", preco: 15, formula: "Q * $", unidade: "M" },
                { codigo: "26013888", nome: "BARRA ROSCADA 1/4 - 1m", preco: 8.5, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013889", nome: "BARRA ROSCADA 3/16 - 1m", preco: 4, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013890", nome: "BARRA ROSCADA 5/16 - 1m", preco: 12.5, formula: "Q * $", unidade: "UNID" },
                { codigo: "43843", nome: "BITS PONTA DUPLA 50mm - 1/4'", preco: 6.4, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601196", nome: "BITS PONTA DUPLA 65mm", preco: 26, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601149", nome: "BIT MAKITA", preco: 8.5, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013836", nome: "BIT DEWALT", preco: 8, formula: "Q * $", unidade: "UNID" },
                { codigo: "43437", nome: "BRAÇO REFLETOR", preco: 20, formula: "C * Q * $", unidade: "M" },
                { codigo: "43313", nome: "BROCA 2,50mm", preco: 6.5, formula: "Q * $", unidade: "UNID" },
                { codigo: "43286", nome: "BROCA 3 PONTAS 3mm", preco: 13, formula: "Q * $", unidade: "UNID" },
                { codigo: "43286", nome: "BROCA 3mm", preco: 13, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601151", nome: "BROCA 4,5mm", preco: 8.6, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601168", nome: "BROCA 6X110mm ENCAIXE RÁPIDO", preco: 25, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600940", nome: "BROCA 8mm ENCAIXE RÁPIDO", preco: 0, formula: "Q * $", unidade: "UNID" }, // valor a verificar
                { codigo: "26013825", nome: "BROCA PARA METAL", preco: 10, formula: "Q * $", unidade: "UNID" },
                { codigo: "843", nome: "BUCHA 6", preco: 0.5, formula: "Q * $", unidade: "UNID" },
                { codigo: "43503", nome: "BUXA 10", preco: 1, formula: "Q * $", unidade: "UNID" },
                { codigo: "827", nome: "BUXA 8", preco: 1, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013898", nome: "CADEADO", preco: 20, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013900", nome: "CANTONEIRA (BARRA DE FERRO V) 0,5POL X 1/8.", preco: 12, formula: "C * Q * $", unidade: "UNID" },
                { codigo: "1417", nome: "CANTONEIRA DE ALUMINIO POLIDO 3/4 (PEDAÇO)", preco: 7.2, formula: "C * Q * $", unidade: "M" },
                { codigo: "1417", nome: "CANTONEIRA DE ALUMINIO POLID (PERÍMETRO)", preco: 7.2, formula: "(A + C) * 2 * $ * Q", unidade: "M²" },
                { codigo: "26013893", nome: "CHAPA AÇO GALVANIZADO - CORTE serra", preco: 190, formula: "C * A * Q * $", unidade: "M" },
                { codigo: "43547", nome: "CHAPA AÇO GALVANIZADO 2mx1m", preco: 1000, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601151", nome: "CHAVE DE FENDA", preco: 20.7, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601152", nome: "CHAVE DE FILIPS", preco: 20.7, formula: "Q * $", unidade: "UNID" },
                { codigo: "43334", nome: "CHAVE PARA MANDRIL", preco: 12, formula: "Q * $", unidade: "UNID" },
                { codigo: "43597", nome: "CORRENTE 4X19X16mm", preco: 19.8, formula: "C * Q * $", unidade: "M" },
                { codigo: "43323", nome: "DESENGRIPANTE WURTH", preco: 29, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601024", nome: "DISCO ABRASIVO DESBASTE 7'", preco: 22, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601000", nome: "DISCO CORTE 1,6 - 4 1/2'", preco: 6, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601096", nome: "DISCO CORTE 14'", preco: 30, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601002", nome: "DISCO CORTE 2.5 -  4 1/2'", preco: 6, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601004", nome: "DISCO DE CORTE 7'", preco: 6, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600967", nome: "DISCO DESBASTE LIXADEIRA 4 1/2'", preco: 10.6, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601003", nome: "DISCO FLAP 4 1/2", preco: 6, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013824", nome: "DOBRADIÇA p/ cavalete", preco: 4, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600980", nome: "DOBRADIÇA", preco: 20, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600998", nome: "DOBRADIÇA 35MM COM AMORTECEDOR", preco: 10.5, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601066", nome: "DOBRADIÇA COM CURVA", preco: 6.5, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013824", nome: "DOBRADIÇA DE CANTO ZINCADA", preco: 2.5, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013897", nome: "DOBRADIÇA PIVOTANTE", preco: 100, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600878", nome: "ELETRODO 2,5 5KG 266 UNID", preco: 1.3, formula: "Q * $", unidade: "UNID" },
                { codigo: "43322", nome: "ESCOVA CIRCULAR", preco: 16, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013910", nome: "ESCOVA CIRCULAR 115MM", preco: 45, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013871", nome: "ESTRUTURA METALICA 100X40.", preco: 150, formula: "C * Q * $", unidade: "M" },
                { codigo: "2601023", nome: "ESTRUTURA METALICA 15X15.", preco: 15, formula: "(A + C) * 2 * $ * Q", unidade: "PRE" },
                { codigo: "426", nome: "ESTRUTURA METALICA 20X20.", preco: 15, formula: "(A + C) * 2 * $ * Q", unidade: "PRE" },
                { codigo: "2601209", nome: "ESTRUTURA METALICA 20X40.", preco: 15, formula: "(A + C) * 2 * $ * Q", unidade: "PRE" },
                { codigo: "26013865", nome: "ESTRUTURA METALICA 25X25.", preco: 15, formula: "(A + C) * 2 * $ * Q", unidade: "PRE" },
                { codigo: "26013866", nome: "ESTRUTURA METALICA 30X30.", preco: 78, formula: "(A + C) * 2 * $ * Q", unidade: "PRE" },
                { codigo: "26013867", nome: "ESTRUTURA METALICA 30X50. GALV", preco: 15, formula: "(A + C) * 2 * $ * Q", unidade: "M" },
                { codigo: "765", nome: "ESTRUTURA METALICA 40X40.", preco: 48, formula: "(A + C) * 2 * $ * Q", unidade: "PRE" },
                { codigo: "2601158", nome: "ESTRUTURA METALICA 50X50.", preco: 48, formula: "(A + C) * 2 * $ * Q", unidade: "PRE" },
                { codigo: "26013872", nome: "ESTRUTURA METALICA CANALETA 100X40.", preco: 132, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013868", nome: "ESTRUTURA METALICA REDONDA 15X15.", preco: 30, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013869", nome: "ESTRUTURA METALICA REDONDA 20X20.", preco: 35, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013870", nome: "ESTRUTURA METALICA REDONDA 40X40.", preco: 48, formula: "C * $ * Q", unidade: "M" },
                { codigo: "43588", nome: "ESTRUTURA METALON TUBULAR 1 POLEGADA", preco: 49, formula: "(A + C) * 2 * $ * Q", unidade: "M" },
                { codigo: "2600881", nome: "ESTRUTURA METALON TUBULAR 2 POLEGADA", preco: 155, formula: "(A + C) * 2 * $ * Q", unidade: "M" },
                { codigo: "26013884", nome: "ESTRUTURA METALON TUBULAR 3 POLEGADA", preco: 260, formula: "(A + C) * 2 * $ * Q", unidade: "M" },
                { codigo: "26013899", nome: "FECHADURA ELETRONICA", preco: 20, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601171", nome: "FURADEIRA IMPACTO BOSH", preco: 469, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013895", nome: "LAMBRI 2,5x1,1.", preco: 165, formula: "C * A * Q * $", unidade: "M" },
                { codigo: "26013894", nome: "LAMBRI 2x1,1.", preco: 165, formula: "C * A * Q * $", unidade: "M" },
                { codigo: "26013896", nome: "LAMBRI 3x1,1.", preco: 185, formula: "C * A * Q * $", unidade: "M" },
                { codigo: "347", nome: "LÂMINA ESTILETE", preco: 0.7, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601095", nome: "LIMPA CONTATO", preco: 31, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601172", nome: "LIXADEIRA DEWALT", preco: 525, formula: "Q * $", unidade: "UNID" },
                { codigo: "43284", nome: "LUVA VINIFLEX", preco: 1.7, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601265", nome: "MANDRIL", preco: 60, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013908", nome: "MOURÃO (MADEIRA) 6A8", preco: 25, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601165", nome: "ÓCULOS DE SEGURANÇA", preco: 10, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601097", nome: "PARABOLTE CHUMBADOR 1/4x65", preco: 8.5, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601098", nome: "PARABOLTE CHUMBADOR 5/16X75", preco: 14.3, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600956", nome: "PARAFUSO 1/4 X 50", preco: 0.6, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601047", nome: "PARAFUSO 1/4 X75", preco: 0.85, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601206", nome: "PARAFUSO 1/4X60", preco: 1, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600825", nome: "PARAFUSO AUTOBROCANTE 4X25(CABEÇA FLAGELADA)", preco: 0.3, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601169", nome: "PARAFUSO AUTOBROCANTE 4X8 (CABEÇA FLAGELADA)", preco: 0.2, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600956", nome: "PARAFUSO SEX 1/4x50/ SEM BUCHA 8/10", preco: 0.6, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601047", nome: "PARAFUSO SEX 1/4x75 / SEM BUCHA 8/10", preco: 0.85, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013882", nome: "PEDAÇO METALICA 100X40.", preco: 150, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013873", nome: "PEDAÇO METALICA 15X15.", preco: 15, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013874", nome: "PEDAÇO METALICA 20X20.", preco: 15, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013879", nome: "PEDAÇO METALICA 20X40.", preco: 15, formula: "C * $ * Q", unidade: "M" },
                { codigo: "26013875", nome: "PEDAÇO METALICA 25X25.", preco: 15, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013876", nome: "PEDAÇO METALICA 30X30.", preco: 78, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013880", nome: "PEDAÇO METALICA 30X50. GALV", preco: 40, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013877", nome: "Pedaço metálica 40X40.", preco: 48, formula: "C * $ * Q", unidade: "M" },
                { codigo: "26013878", nome: "PEDAÇO METALICA 50X50.", preco: 48, formula: "C * $ * Q", unidade: "M" },
                { codigo: "26013883", nome: "PEDAÇO METALICA CANALETA 100X40.", preco: 132, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013885", nome: "PEDAÇO METALON TUBULAR 1 POLEGADA", preco: 49, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013886", nome: "PEDAÇO METALON TUBULAR 2 POLEGADA", preco: 155, formula: "C * Q * $", unidade: "M" },
                { codigo: "26013887", nome: "PEDAÇO METALON TUBULAR 3 POLEGADA", preco: 260, formula: "C * Q * $", unidade: "M" },
                { codigo: "43339", nome: "PERFIL ENRIGECIDO 75 MM", preco: 39, formula: "C * Q * $", unidade: "M" },
                { codigo: "2601087", nome: "PORCA 1/4.", preco: 0.3, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013891", nome: "PORCA 3/16.", preco: 0.2, formula: "Q * $", unidade: "UNID" },
                { codigo: "201088", nome: "PORCA 5/15.", preco: 0.45, formula: "Q * $", unidade: "M" },
                { codigo: "2601148", nome: "REBITADOR PRO - STANLEY", preco: 92.5, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600879", nome: "REBITE 4X10", preco: 0.3, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601028", nome: "REBITE 4X8", preco: 0.15, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601068", nome: "ROLDANA EM V COM ROLAMENTO", preco: 38, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601147", nome: "SERRA COPO DIAMANTADA", preco: 199, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013907", nome: "SOLDA BARRA", preco: 18, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601149", nome: "SOQUETE MAGNÉTICO 5/16mm SEXTAVADO", preco: 8.5, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600876", nome: "SUPORTE", preco: 5, formula: "Q * $", unidade: "UNID" },
                { codigo: "829", nome: "TOCO EUCALIPTO", preco: 20, formula: "Q * $", unidade: "UNID" },
                { codigo: "43587", nome: "TRANQUETA", preco: 35, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013892", nome: "VERGALHÃO 3/8.", preco: 12, formula: "C * Q * $", unidade: "UNID" },
                { codigo: "43848", nome: "VERGALHÃO 5/16.", preco: 9, formula: "C * Q * $", unidade: "UNID" },
                { codigo: "260113837", nome: "", preco: 0, formula: "", unidade: "" },
            ],
            "LONAS E ADESIVOS": [
                { codigo: "1154", nome: "ABRAÇADEIRA 250MM", preco: 1.00, formula: "(((C[429] + A[429])*2 + (C[534] + A[534])*2) * 4) * Q * $", unidade: "UNID" }, //mudar formula para 'comprimento do produto de codigo 934 * Q * $' mude a propriedade deste produto de forma que os dados vindo do produto de codigo 934 n possão ser alterados na pagina executavel
                { codigo: "2600590", nome: "ABRAÇADEIRA 350MM", preco: 1.00, formula: "(((C[429] + A[429])*2 + (C[534] + A[534])*2) * 4) * Q * $", unidade: "UNID" }, //mudar formula para 'comprimento do produto de codigo 934 * Q * $' mude a propriedade deste produto de forma que os dados vindo do produto de codigo 934 n possão ser alterados na pagina executavel
                { codigo: "416", nome: "ADESIVO", preco: 85.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "428", nome: "ADESIVO (FIBRA DE CARBONO)", preco: 110.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601190", nome: "ADESIVO BLACKLIGHT", preco: 97.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "", nome: "ADESIVO BRANCO COM TEXTURA", preco: 60.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601354", nome: "ADESIVO CIMENTO QUEIMADO", preco: 60.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "310", nome: "ADESIVO COLOR CORTE RETO", preco: 45.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "356", nome: "ADESIVO COLUNA DE PORTA", preco: 200.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "311", nome: "ADESIVO ESPELHADO", preco: 75.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "803", nome: "ADESIVO FAIXA DE PORTA", preco: 25.00, formula: "C * Q * $", unidade: "M²" },
                { codigo: "1263", nome: "ADESIVO GOLD METALICO", preco: 110.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "915", nome: "ADESIVO JATEADO", preco: 70.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601355", nome: "ADESIVO MADEIRA", preco: 60.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "", nome: "ADESIVO PERFURADO", preco: 85.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43567", nome: "ADESIVO PRATA METALICO", preco: 110.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43564", nome: "ADESIVO PROMO FAST", preco: 40.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "312", nome: "ADESIVO REFLETIVO", preco: 120.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "", nome: "ADESIVO REVESTWALL ARTISTICO", preco: 120.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "1417", nome: "CANTONEIRA DE ALUMINIO POLID (PERÍMETRO)", preco: 7.20, formula: "(A + C) * 2 * $ * Q", unidade: "M²" },
                { codigo: "899", nome: "CORDÃO PARA BANNER", preco: 1.00, formula: "C[429] * Q * $", unidade: "M" },  //mudar formula para 'comprimento do produto de codigo 429 * Q * $' mude a propriedade deste produto de forma que os dados vindo do produto de codigo 429 n possão ser alterados na pagina executavel
                { codigo: "1404", nome: "ESPÁTULA", preco: 3.80, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601264", nome: "ESPÁTULA AÇO", preco: 4.90, formula: "Q * $", unidade: "UNID" },
                { codigo: "934", nome: "ILHOIS", preco: 0.60, formula: "(((C[429] + A[429])*2 + (C[534] + A[534])*2) * 4) * Q * $", unidade: "UNID" }, //mude a matematica para ' C * Q * $'' C cerpre sera = ((C do produto 429 + C do produto 429 + A do produto 429 + A do produto 429) * 4) + ((C do produto 534 + C do produto 534 + A do produto 534 + A do produto 534) * 4)	 
                { codigo: "", nome: "IMPRESSÃO PRETA E BRANCA DE PLANTA A0", preco: 17.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "", nome: "IMPRESSÃO PRETA E BRANCA DE PLANTA A1", preco: 14.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "", nome: "IMPRESSÃO PRETA E BRANCA DE PLANTA A2", preco: 11.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "", nome: "IMPRESSÃO PRETA E BRANCA DE PLANTA A3", preco: 8.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "", nome: "IMPRESSÃO COLORIDA DE PLANTA A0", preco: 18.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "", nome: "IMPRESSÃO COLORIDA DE PLANTA A1", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "", nome: "IMPRESSÃO COLORIDA DE PLANTA A2", preco: 12, formula: "Q * $", unidade: "UNID" },
                { codigo: "", nome: "IMPRESSÃO COLORIDA DE PLANTA A3	", preco: 9, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600651", nome: "INSULFILM AUTOMOTIVO", preco: 120, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43176", nome: "LONA BLACKLIGHT", preco: 100, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "353", nome: "LONA ILUMINAÇÃO", preco: 85, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "429", nome: "LONA IMPRESSA", preco: 85, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "861", nome: "LONA PARA TOLDOS", preco: 85, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "534", nome: "LONA PROMOÇÃO -IMPRESSÃO RASCUNHO", preco: 70, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "819", nome: "LONA SEM IMPRESSÃO-corte reto", preco: 45, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2600800", nome: "MADEIRA PARA BANNER", preco: 2, formula: "(C[429] + C[534]) * Q * $", unidade: "M²" },	//mude a formula para 'C * Q * $' C sempre sera = 'C do produto 429 + C do produto 534'		
                { codigo: "1319", nome: "MÁSCARA", preco: 26, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "1222", nome: "PAPEL OUTDOOR", preco: 45, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "168", nome: "PAPEL PLANTA", preco: 55, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2600423", nome: "PERFIL C PARA BANNER", preco: 6, formula: "(C[429] + C[534]) * Q[2600800] * $", unidade: "M²" },	//mude a formula para 'C * Q * $' C sempre sera = 'C do produto 429 + C do produto 534' e Q sempre sera = 'Q do produto 2600800'	 
                { codigo: "2600424", nome: "PONTEIRA PARA BANNER", preco: 1, formula: "((Q[2600423]/2) * 4) * $", unidade: "UNID" },	// mude a formula para 'Q * $'	Q sempre sera = '(Q do produto 2600423 / 2) * 4'	 
                { codigo: "43601", nome: "VERNIZ P/ LONA (REND. 30UNID/L)", preco: 15, formula: "C[429] * A[429] * Q * $", unidade: "M²" }, // mude a formula para 'C * A * Q * $' c sempr sera = 'C do produto 429' e A sempre sera = 'A do produto 429'
                { codigo: "", nome: "PAPEL PARANÁ", preco: 50, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "", nome: "IMÃ DE C ARRO (IMÃ + ADESIVO)", preco: 250, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "260113837", nome: "", preco: 0, formula: "", unidade: "" },

            ],
            "ACM FUNDO": [
                { codigo: "334", nome: "ACM COM ESTRUTURA", preco: 350.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "1445", nome: "ACM COR BRILHO FUNDO PLACA", preco: 200.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2600865", nome: "ACM DARK GREY", preco: 250.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601049", nome: "ACM FUNDO FACHADA", preco: 350.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "1422", nome: "ACM LETRAS (ROUTER)", preco: 400.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "1421", nome: "ACM LETRAS ESPELHADO, ESCOVADO", preco: 600.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "960", nome: "ACM MADEIRA", preco: 360.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "26013829", nome: "ACM PRETO", preco: 250.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43335", nome: "ATIVADOR DE TEKBOND", preco: 58.00, formula: "Q * $", unidade: "M²" },
                { codigo: "897", nome: "FITA DUPLA FACE 15mm", preco: 6.00, formula: "Q * $", unidade: "M²" },
                { codigo: "2600710", nome: "FITA DUPLA FACE 9mm", preco: 3.30, formula: "Q * $", unidade: "M²" },
                { codigo: "26013911", nome: "FITA DUPLA FACE CINZA 6mm", preco: 2.50, formula: "Q * $", unidade: "M" },
                { codigo: "2600971", nome: "GABARITO", preco: 10.00, formula: "C * A * Q * $", unidade: "M" },
                { codigo: "43820", nome: "MANTA ISOLAMENTO", preco: 6.50, formula: "Q * $", unidade: "M" },
                { codigo: "43332", nome: "MASSA PLÁSTICA", preco: 20.00, formula: "Q * $", unidade: "M²" },
                { codigo: "43294", nome: "PREGO DE TELHA", preco: 0.80, formula: "Q * $", unidade: "M" },
                { codigo: "2600970", nome: "PROMOTOR ADERENCIA - 7225", preco: 240.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2601008", nome: "SILICONE 180G", preco: 25.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43632", nome: "SILICONE 260G", preco: 26.90, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600880", nome: "SILICONE PRETO", preco: 25.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43745", nome: "PU40 SELANTE", preco: 30.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600745", nome: "TEKBOND", preco: 35.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43627", nome: "VEDA CALHA", preco: 40.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "260113837", nome: "", preco: 0, formula: "", unidade: "" },

            ],
            "PVC": [
                { codigo: "2601286", nome: "ACETADO", preco: 50.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "26013851", nome: "ACRÍLICO 10mm - CORTE LASER", preco: 750.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2600861", nome: "ACRÍLICO 2mm - CORTE LASER", preco: 400.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43345", nome: "ACRÍLICO 2mm ESPELHADO PRATA 2X1 (LASER)", preco: 600.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43333", nome: "ACRÍLICO 2mm ESPELHADO DOURADO 2X1 (LASER)", preco: 600.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601285", nome: "ACRÍLICO 2mm ESPELHADO ROSE 2X1 (LASER)", preco: 600.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "260113837", nome: "ACRÍLICO 3mm - CORTE LASER", preco: 450.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601216", nome: "ACRÍLICO 4mm - CORTE LASER", preco: 500.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43821", nome: "ACRÍLICO 6mm - CORTE LASER", preco: 600.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601229", nome: "ACRÍLICO AZUL 6mm - CORTE LASER", preco: 635.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2600707", nome: "BOTÃO DE ACABAMENTO (ESCONDE PARAFUSO)", preco: 8.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "43503", nome: "BUXA 10", preco: 1.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "843", nome: "BUXA 6", preco: 0.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "827", nome: "BUXA 8", preco: 1.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600900", nome: "BUXA PARA PREGO", preco: 1.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600901", nome: "DOBRA ACRÍLICO", preco: 0.70, formula: "Q * $", unidade: "DOBRA" },
                { codigo: "2600710", nome: "FITA DUPLA FACE 15mm", preco: 6.00, formula: "Q * $", unidade: "M" },
                { codigo: "2601005", nome: "FITA DUPLA FACE 9mm", preco: 3.30, formula: "Q * $", unidade: "M" },
                { codigo: "2600971", nome: "GABARITO", preco: 10.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601035", nome: "PARAFUSO PHILIPS 3,5X16", preco: 0.10, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601033", nome: "PARAFUSO PHILIPS 3,5x25", preco: 0.10, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600825", nome: "PARAFUSO PHILIPS 3,5x40", preco: 0.30, formula: "Q * $", unidade: "UNID" },
                { codigo: "43582", nome: "PARAFUSO PHILIPS 6x60", preco: 0.60, formula: "Q * $", unidade: "UNID" },
                { codigo: "601034", nome: "PARAFUSO PHILIPS 4x50", preco: 0.36, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601174", nome: "PROLONGADOR 10mm", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601348", nome: "PROLONGADOR INOX 20mm", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601349", nome: "PROLONGADOR INOX 50mm", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601238", nome: "PS 2mm - CORTE LASER", preco: 100.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2600966", nome: "PS 3mm - CORTE LASER", preco: 150.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2600805", nome: "PVC 2mm", preco: 120.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2600806", nome: "PVC 3mm", preco: 150.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "1258", nome: "PVC 6mm", preco: 170.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2600807", nome: "PVC EXPANDIDO - CORTAR", preco: 60000.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2600808", nome: "PVC EXPANDIDO 10mm", preco: 500.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601044", nome: "PVC EXPANDIDO 15mm", preco: 202.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "26011323", nome: "PVC EXPANDIDO 20mm", preco: 235.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43296", nome: "PVC EXPANDIDO 25mm", preco: 270.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "26013831", nome: "PVC EXPANDIDO 30mm", preco: 302.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601350", nome: "SUPORTE TUCANO G (8CM) - TC029", preco: 60.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601351", nome: "SUPORTE TUCANO M (7CM) - TC026", preco: 40.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601352", nome: "SUPORTE TUCANO P (4CM) - TC023", preco: 26.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "260113837", nome: "", preco: 0, formula: "", unidade: "" },

            ],
            "ILUMINAÇÃO": [
                { codigo: "2600454", nome: "ARANDELA", preco: 120.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43437", nome: "BRACO REFLETOR 15X15", preco: 20.00, formula: "C * Q * $", unidade: "M" },
                { codigo: "2601194", nome: "CLAMPER (PROTETOR CONTRA RAIOS)", preco: 63.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43584", nome: "COTOVELO 90 G", preco: 1.20, formula: "Q * $", unidade: "UNID" },
                { codigo: "43585", nome: "COTOVELO INTERNO 20X10", preco: 1.20, formula: "Q * $", unidade: "UNID" },
                { codigo: "834", nome: "CONECTOR BNC PINO FIXO", preco: 6.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43856", nome: "DIFUSOR PERFIL ACRÍLICO LED", preco: 45.00, formula: "C * Q * $", unidade: "M" },
                { codigo: "1284", nome: "FIO 2X0,5", preco: 2.00, formula: "Q * $", unidade: "M" },
                { codigo: "1348", nome: "FIO BICOLOR", preco: 2.00, formula: "Q * $", unidade: "M" },
                { codigo: "1284", nome: "FIO PARALELO 2X0,5", preco: 2.00, formula: "Q * $", unidade: "M" },
                { codigo: "668", nome: "FIO PARALELO 2X0,75", preco: 2.00, formula: "Q * $", unidade: "M" },
                { codigo: "2601082", nome: "FIO PARALELO PRETO", preco: 4.50, formula: "Q * $", unidade: "M" },
                { codigo: "2600983", nome: "FITA ISOLANTE", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "638", nome: "FITA LED 50X50", preco: 18.00, formula: "C * Q * $", unidade: "M" },
                { codigo: "43888", nome: "FITA LED NEON", preco: 24.00, formula: "C * Q * $", unidade: "M" },
                { codigo: "43331", nome: "FIXA CABO", preco: 1.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600935", nome: "FONTE 12V 2A", preco: 67.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43673", nome: "FONTE 12V 5A", preco: 75.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "1496", nome: "INTERRUPTOR AUTOMÁTICO 180°", preco: 35.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "1495", nome: "INTERRUPTOR AUTOMÁTICO 360°", preco: 38.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43578", nome: "INTERRUPTOR p/ fio", preco: 3.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "43785", nome: "INTERRUPTOR PARA MÓVEL", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600697", nome: "INTERRUPTOR PAREDE", preco: 7.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "43501", nome: "LAMPADA LED 0,60", preco: 30.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43502", nome: "LAMPADA LED 1,2", preco: 40.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "", nome: "LED NEON", preco: 10.00, formula: "C * Q * $", unidade: "M" },
                { codigo: "43018", nome: "LED MODULO COM 3 LENTES", preco: 24.00, formula: "C * Q * $", unidade: "M" },
                { codigo: "2600422", nome: "PAINEL LED 12W", preco: 36.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "26101305", nome: "PASSA FIO COM ALMA DE AÇO - 15 MT", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601306", nome: "PASSA FIO COM ALMA DE AÇO - 20 MT", preco: 30.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43842", nome: "PERFIL DE LED", preco: 75.00, formula: "C * Q * $", unidade: "M" },
                { codigo: "43110", nome: "PLUG MACHO", preco: 5.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601195", nome: "QUADRO DE DISTRIBUIÇÃO", preco: 61.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "1423", nome: "REFLETOR LED 10W", preco: 46.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601078", nome: "REFLETOR LED 20W", preco: 55.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600847", nome: "REFLETOR LED 50W", preco: 125.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "1012", nome: "RELE FOTOCELULA", preco: 50.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43833", nome: "SOQUETE CERÂMICA P/LAMPADA E27", preco: 5.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "768", nome: "SOQUETE P/LAMPADA TUBULAR", preco: 3.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "", nome: "SOLDA DE ESTANHO (BRANCA)", preco: 12.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600927", nome: "SPOT LAD 6W", preco: 20.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600927", nome: "SPOT LAD 6W", preco: 20.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600590", nome: "SUPORTE PRA LAMPADA", preco: 2.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "1182", nome: "TIMER", preco: 115.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "", nome: "TOMADA FÊMEA", preco: 3.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43510", nome: "TOMADA MACHO", preco: 5.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "4351054", nome: "TOMADA MACHO", preco: 1.55, formula: "Q * $", unidade: "UNID" },
                { codigo: "260113837", nome: "", preco: 0, formula: "", unidade: "" },

            ],
            "MDF": [
                { codigo: "2601124", nome: "ARGOLA 4MM", preco: 0.10, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601123", nome: "ARGOLA 6MM", preco: 0.15, formula: "Q * $", unidade: "UNID" },
                { codigo: "1458", nome: "ARGOLA COM CORRENTE", preco: 0.60, formula: "Q * $", unidade: "UNID" },
                { codigo: "43262", nome: "ARGOLA S22 S CORRENTE", preco: 0.30, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600707", nome: "BOTAO DE ACABAMENTO", preco: 8.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "43503", nome: "BUXA_10", preco: 1.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "843", nome: "BUXA_6", preco: 0.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "43503", nome: "BUXA_8", preco: 1.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "827", nome: "BUXA PARA PREGO", preco: 1.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601020", nome: "CANTONEIRA 2_FUROS", preco: 1.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600708", nome: "CANTONEIRA 3_FUROS", preco: 2.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601022", nome: "CANTONEIRA METAL_2_FUROS", preco: 1.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "1379", nome: "CHAVEIRO M505", preco: 2.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601173", nome: "COLA ALMASUPER", preco: 18.60, formula: "Q * $", unidade: "KIT" },
                { codigo: "2600997", nome: "COLA DE CONTATO", preco: 30.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2600745", nome: "COLA INSTANTANEA TEKBOND", preco: 35.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "COMPENSADO NAVAL_15MM", preco: 155.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601121", nome: "CORREDICA 200MM", preco: 22.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43595", nome: "CORREDICA 300MM", preco: 29.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601093", nome: "CORREDICA 350MM", preco: 45.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601094", nome: "CORREDICA 400MM", preco: 40.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43307", nome: "CORREDICA 500MM", preco: 48.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "239902", nome: "DOBRADICA MEIA_POLEGADA", preco: 1.30, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600998", nome: "DOBRADICA 35MM COM AMORTECEDOR", preco: 10.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "DOBRADICA ABRE 2 LADOS CROMADA", preco: 100.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "DOBRADICA ABRE 2 LADOS PRETA", preco: 78.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601066", nome: "DOBRADICA CURVA", preco: 6.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "43637", nome: "DOBRADICA PEQUENA", preco: 1.30, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601133", nome: "DOBRADICA PRETA 85MM", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601029", nome: "FECHADURA 18MM", preco: 16.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601046", nome: "FECHADURA 32MM", preco: 17.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "26001132", nome: "FECHADURA TUBULAR", preco: 140.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43523", nome: "FECHO MEDIO CAIXA", preco: 5.90, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601220", nome: "FECHO_TRINCO GANGORRA", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601062", nome: "FITA DE BORDO 19MM", preco: 5.00, formula: "Q * $", unidade: "M" },
                { codigo: "0", nome: "FITA DE BORDO 19MM CRISTALO", preco: 5.00, formula: "Q * $", unidade: "M" },
                { codigo: "0", nome: "FITA DE BORDO 22MM", preco: 2.60, formula: "Q * $", unidade: "M" },
                { codigo: "0", nome: "FITA DE BORDO 22MM CRISTALO", preco: 6.00, formula: "Q * $", unidade: "M" },
                { codigo: "43845", nome: "FITA DE BORDO 340MM", preco: 15.80, formula: "Q * $", unidade: "M" },
                { codigo: "2601018", nome: "FITA DE BORDO 35MM", preco: 1.60, formula: "Q * $", unidade: "M" },
                { codigo: "2601064", nome: "FITA DE BORDO 35MM_CRISTALO", preco: 7.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601223", nome: "FITA DE BORDO 40MM", preco: 1.85, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "FITA DE BORDO 40MM CRISTALO", preco: 8.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "FITA DE BORDO CINZA CLARO 19MM", preco: 5.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "FITA DE BORDO CINZA CLARO 22MM", preco: 5.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "FITA DE BORDO GRAFITE 19MM", preco: 5.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "FITA DE BORDO GRAFITE 22MM", preco: 5.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "FITA DE BORDO GRAFITE 45MM", preco: 5.00, formula: "Q * $", unidade: "M" },
                { codigo: "2601205", nome: "GANCHO BRONZE", preco: 9.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "GANCHO DE FERRO COM ROSCA 14X30", preco: 1.00, formula: "Q * $", unidade: "" },
                { codigo: "0", nome: "GANCHO PEQUENO", preco: 0.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601166", nome: "GRAMPO GRANDE FIXACAO", preco: 115.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601167", nome: "GRAMPO PEQUENO FIXACAO", preco: 25.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601262", nome: "K OTHRINE SC25", preco: 70.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43583", nome: "KIT ROLDANA 624025", preco: 60.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43316", nome: "LIXA RODA 35X80MM", preco: 34.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43321", nome: "LIXA RODA MINI 50X20MM", preco: 13.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "MDF 10MM BRANCO", preco: 120.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43060", nome: "MDF 10MM CRU", preco: 90.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43060", nome: "MDF 10MM CRU CORTE ROUTER", preco: 200.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF 15MM CINZA CLARO", preco: 125.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2600944", nome: "MDF 15MM CRISTALO", preco: 250.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "1446", nome: "MDF 15MM CRU", preco: 110.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF 15MM CRU CORTE ROUTER", preco: 250.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF 15MM GRAFITTE", preco: 130.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF 15MM VARIAS CORES", preco: 128.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF 15MM AZUL SECRETO", preco: 200.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF 15MM BRANCO", preco: 100.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF 18MM CRU", preco: 60.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF 18MM CRU CORTE ROUTER", preco: 170.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43057", nome: "MDF 3MM CRU", preco: 40.00, formula: "C * A * Q * $", unidade: "UNID" },
                { codigo: "43057", nome: "MDF 3MM CRU CORTE_LASER", preco: 150.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF 3MM BRANCO", preco: 70.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "43056", nome: "MDF 6MM CRU", preco: 60.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF 6MM BRANCO", preco: 100.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF 6MM CRU CORTE LASER", preco: 170.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF CANALETADO 15MM", preco: 160.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF CANALETADO 15MM COM EMENDA", preco: 120.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF MADEIRA FREIJO AMAZONAS", preco: 138.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "0", nome: "MDF PRETO NOTTIE", preco: 132.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601169", nome: "PARAFUSO CABEC FLAGELADA 4 2X13", preco: 0.20, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601035", nome: "PARAFUSO PHILIPS 3 5X16", preco: 0.10, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601033", nome: "PARAFUSO PHILIPS 3 5X25", preco: 0.10, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600825", nome: "PARAFUSO PHILIPS 3 5X40", preco: 0.30, formula: "Q * $", unidade: "UNID" },
                { codigo: "43583", nome: "PARAFUSO PHILIPS 4X22", preco: 0.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "43582", nome: "PARAFUSO PHILIPS 6X60", preco: 0.60, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600956", nome: "PARAFUSO SEX 1 4X50 SEM BUCHA", preco: 0.60, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601047", nome: "PARAFUSO SEX 1 4X75 SEM BUCHA", preco: 0.85, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601034", nome: "PARAFUSO PHILIPS 4X50", preco: 0.36, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601044", nome: "PE PVC EXPANDIDO 5X5 15M", preco: 3.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "1258", nome: "PE PVC EXPANDIDO 5X5 6M", preco: 3.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601021", nome: "PE PLASTICO", preco: 1.20, formula: "Q * $", unidade: "UNID" },
                { codigo: "43835", nome: "PE REDONDO 10CM", preco: 21.80, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601017", nome: "PERFIL PUXADOR", preco: 80.00, formula: "C * Q $", unidade: "M" },
                { codigo: "0", nome: "PINAZIO", preco: 200.00, formula: "C * A * Q * $", unidade: "UNID" },
                { codigo: "0", nome: "PISTAO", preco: 16.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43532", nome: "PREGO 15X15", preco: 0.05, formula: "Q * $", unidade: "UNID" },
                { codigo: "43530", nome: "PREGO 6X0_9", preco: 0.05, formula: "Q * $", unidade: "UNID" },
                { codigo: "43531", nome: "PREGO 9X15", preco: 0.05, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "PROLONGADOR 10MM", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "PROLONGADOR INOX 20MM", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "PROLONGADOR INOX 50MM", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43840", nome: "PUXADOR 030 CR 8863", preco: 20.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601048", nome: "PUXADOR 096 2535", preco: 12.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601048", nome: "PUXADOR 128 2531", preco: 12.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "PUXADOR CAVA", preco: 100.00, formula: "C * Q * $", unidade: "M" },
                { codigo: "2601175", nome: "PUXADOR G", preco: 17.80, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601176", nome: "PUXADOR P", preco: 16.80, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601016", nome: "PUXADOR REDONDO", preco: 15.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43589", nome: "RODA 210 SILICONE", preco: 25.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43590", nome: "RODA 210 SILICONE COM FREIO", preco: 35.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600699", nome: "RODA G SILICONE COM FREIO", preco: 18.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600700", nome: "RODA G SILICONE S FREIO", preco: 18.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "RODA PLASTICO", preco: 0.00, formula: "", unidade: "UNID" },
                { codigo: "2601029", nome: "RODA SILICONE COM FREIO", preco: 19.80, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601049", nome: "RODAPE ACM", preco: 350.00, formula: "C * A * Q * $", unidade: "M²" },
                { codigo: "2601110", nome: "RODIZIO 35MM S FREIO", preco: 16.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "RODIZIO 50MM S FREIO", preco: 18.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43329", nome: "SAPATA NIVELADORA 31MM", preco: 6.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601204", nome: "SERRA CIRCULAR 250MM", preco: 582.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "SUPORTE TUCANO G TC029", preco: 60.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "SUPORTE TUCANO M TC026", preco: 40.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "0", nome: "SUPORTE TUCANO P TC023", preco: 26.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43587", nome: "TRANQUETA", preco: 35.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43593", nome: "TRILHO INFERIOR SP014 15MM", preco: 27.00, formula: "C * Q * $", unidade: "UNID" },
                { codigo: "43596", nome: "TRILHO SUPERIOR SP013A 15 4MM", preco: 36.60, formula: "C * Q * $", unidade: "UNID" },
                { codigo: "260113837", nome: "", preco: 0, formula: "", unidade: "" },
            ],
            "PINTURA": [
                { codigo: "2600965", nome: "GASOLINA LIMPESA", preco: 8.00, formula: "Q * $", unidade: "LT" },
                { codigo: "26013912", nome: "FILTRO PARA TINTA", preco: 2.70, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600874", nome: "LIXA 80 ,150 ,320", preco: 4.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "43308", nome: "PANO POLIMENTO", preco: 10.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "26013864", nome: "PRIMER", preco: 20.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2600859", nome: "PRIMER (PROMOTOR DE ADERÊNCIA)- 7225", preco: 240.00, formula: "", unidade: "LT" },
                { codigo: "43129", nome: "RESINA RÍGIDA (ml/cUNID)", preco: 226.00, formula: "C * A * Q * $", unidade: "M²" },

                { codigo: "", nome: "QUANT. EM ML", preco: 1750, formula: "C[43129] * A[43129] * Q[43129] * $", unidade: "ML" },
                { codigo: "", nome: "QUANT. EM LITROS", preco: 1.75, formula: "C[43129] * A[43129] * Q[43129] * $", unidade: "LT" },


                { codigo: "623", nome: "SELADOR MADEIRA", preco: 40.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2600873", nome: "THINER (MEIO LITRO)", preco: 17.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2600875", nome: "TINTA AUTOMOTIVA (BASICA)", preco: 70.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2601085", nome: "TINTA BRANCO NEVE", preco: 100.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2601170", nome: "TINTA ESMALTE BRANCO 115-100", preco: 175.00, formula: "Q * $", unidade: "LT" },
                { codigo: "43297", nome: "TINTA ESMALTE PRETO 115-022", preco: 175.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2601090", nome: "TINTA GALVITE", preco: 154.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2601086", nome: "TINTA PRETO FOSCO", preco: 48.00, formula: "Q * $", unidade: "LT" },
                { codigo: "43295", nome: "TINTA SPRAY", preco: 18.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2600736", nome: "TINTA SPRAY BRANCO BRILHANTE - TEKBOND", preco: 20.00, formula: "Q * $", unidade: "LT" },
                { codigo: "26013966", nome: "TINTA SPRAY BRANCO FOSCO - TEKBOND", preco: 30.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2600738", nome: "TINTA SPRAY DOURADO", preco: 40.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2600738", nome: "TINTA SPRAY PRATA - TEKBOND", preco: 40.00, formula: "Q * $", unidade: "LT" },
                { codigo: "43337", nome: "TINTA SPRAY PRETO BRILHANTE - CHEMI COLOR", preco: 20.00, formula: "Q * $", unidade: "LT" },
                { codigo: "43629", nome: "TINTA SPRAY PRETO FOSCO - CHEMI COLOR", preco: 20.00, formula: "Q * $", unidade: "LT" },
                { codigo: "43629", nome: "TINTA SPRAY PRETO FOSCO - TEKBOND", preco: 25.00, formula: "Q * $", unidade: "LT" },
                { codigo: "2600737", nome: "TINTA SPRAY ROSE GOLD METALLIK - 56 - colorgin", preco: 50.00, formula: "Q * $", unidade: "LT" },
                { codigo: "43138", nome: "TINTA SPRAY VERMELHO", preco: 20.00, formula: "Q * $", unidade: "LT" },
                { codigo: "43571", nome: "VERNIZ", preco: 70.00, formula: "Q * $", unidade: "LT" },
                { codigo: "", nome: "ESTOPA", preco: 2.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "260113837", nome: "", preco: 0, formula: "Q * $", unidade: "" }
            ],
            "MÃO DE OBRA": [
                { codigo: "2600885", nome: "ALMOÇO/LANCHE", preco: 25.00, formula: "Q * $", unidade: "UNID" },
                { codigo: "2601119", nome: "ALUGUEL DE ANDAIME", preco: 3.00, formula: "Q * $", unidade: "PÇ" },
                { codigo: "2600846", nome: "FRETE", preco: 3.00, formula: "Q * $", unidade: "H" },
                { codigo: "", nome: "TEMPO DE PRODUÇÃO (ESTRADA)", preco: 0.83, formula: "Q[2600846] / (0.6 * 60) * 2 * 15", unidade: "H" },
                { codigo: "", nome: "IMPRESSÃO A4 COLORIDA", preco: 2.50, formula: "Q * $", unidade: "UNID" },
                { codigo: "2600884", nome: "TEMPO ATENDIMENTO", preco: 20.00, formula: "Q * $", unidade: "H" },
                { codigo: "26013915", nome: "TEMPO DE DESIGNER E ARQUIVOS - TODY", preco: 50.00, formula: "Q * $", unidade: "H" },
                { codigo: "26013915", nome: "TEMPO DE DESIGNER E ARQUIVOS - LORENA", preco: 50.00, formula: "Q * $", unidade: "H" },
                { codigo: "26013915", nome: "TEMPO DE DESIGNER E ARQUIVOS - EDUARDA", preco: 50.00, formula: "Q * $", unidade: "H" },
                { codigo: "26013915", nome: "TEMPO DE DESIGNER E ARQUIVOS - DANI", preco: 50.00, formula: "Q * $", unidade: "H" },
                { codigo: "26013915", nome: "TEMPO DE DESIGNER E ARQUIVOS -", preco: 50.00, formula: "Q * $", unidade: "H" },
                { codigo: "26013915", nome: "TEMPO DE DESIGNER E ARQUIVOS - PEDRO", preco: 50.00, formula: "Q * $", unidade: "H" },
                { codigo: "26013915", nome: "TEMPO DE DESIGNER E ARQUIVOS - MAICON", preco: 50.00, formula: "Q * $", unidade: "H" },
                { codigo: "26013915", nome: "TEMPO DE DESIGNER E ARQUIVOS - LUIZ", preco: 50.00, formula: "Q * $", unidade: "H" },
                { codigo: "26013915", nome: "TEMPO DE DESIGNER E ARQUIVOS - ALICE", preco: 50.00, formula: "Q * $", unidade: "H" },
                { codigo: "2600884", nome: "TEMPO DE INSTALAÇÃO (HORA * Nº DE FUNCIONÁRIO)", preco: 15.00, formula: "Q * $", unidade: "H" },
                { codigo: "43822", nome: "TEMPO DE LASER - MATERIAL CLIENTE (VERIFICAR NO PROGRAMA DE CORTE)", preco: 1.00, formula: "C * Q * $", unidade: "H" },
                { codigo: "43822", nome: "TEMPO DE LASER (VERIFICAR NO PROGRAMA DE CORTE)", preco: 15, formula: "(C / 60 * Q) * $", unidade: "H" },
                { codigo: "630", nome: "TEMPO DE PINTURA", preco: 20.00, formula: "Q * $", unidade: "H" },
                { codigo: "630", nome: "TEMPO PRODUÇÃO COMUNICAÇÃO VISUAL", preco: 20.00, formula: "Q * $", unidade: "H" },
                { codigo: "630", nome: "TEMPO INSTALAÇÃO COMUNICAÇÃO VISUAL", preco: 20.00, formula: "Q * $", unidade: "H" },
                { codigo: "630", nome: "TEMPO PRODUÇAO LETRA CAIXA (ACM/GALVAN)	2h/LETRA", preco: 15.00, formula: "Q * $", unidade: "H" },
                { codigo: "2600884", nome: "TEMPO PRODUÇAO MÓVEIS", preco: 15.00, formula: "Q * $", unidade: "H" },
                { codigo: "2600884", nome: "TEMPO INSTALAÇÃO MÓVEIS", preco: 15.00, formula: "Q * $", unidade: "H" },
                { codigo: "2600884", nome: "TEMPO PRODUÇAO PRESTAÇÃO DE SERVIÇO", preco: 16.00, formula: "Q * $", unidade: "H" },
                { codigo: "260113837", nome: "", preco: 0, formula: "", unidade: "" },
            ],
        };

        // ======= TEMA =======
        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            document.body.classList.toggle('dark-theme', isDarkTheme);
            localStorage.setItem('darkTheme', isDarkTheme);

            const icon = document.querySelector('.btn-theme i');
            icon.className = isDarkTheme ? 'fas fa-sun' : 'fas fa-moon';

            showNotification(`Tema ${isDarkTheme ? 'escuro' : 'claro'} ativado!`, 'info');
        }

        // Inicializa tema
        if (isDarkTheme) {
            document.body.classList.add('dark-theme');
            document.querySelector('.btn-theme i').className = 'fas fa-sun';
        }

        // ======= NOTIFICAÇÕES =======
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.innerHTML = `
                <i class="fas fa-${getIconForType(type)}"></i> ${message}
            `;
            notification.className = `notification ${type}`;
            notification.classList.add('show');

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function getIconForType(type) {
            const icons = {
                success: 'check-circle',
                error: 'exclamation-triangle',
                warning: 'exclamation-circle',
                info: 'info-circle'
            };
            return icons[type] || 'info-circle';
        }

        // ======= MODAIS =======
        function showAddProductModal() {
            document.getElementById('addProductModal').style.display = 'block';
        }

        function showImportModal() {
            document.getElementById('importModal').style.display = 'block';
        }

        function showCalculatorModal() {
            document.getElementById('calculatorModal').style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // ======= CALCULADORA =======
        let calcValue = '';

        function calcAppend(value) {
            calcValue += value;
            document.getElementById('calcDisplay').value = calcValue;
        }

        function calcClear() {
            calcValue = '';
            document.getElementById('calcDisplay').value = '';
        }

        function calcDelete() {
            calcValue = calcValue.slice(0, -1);
            document.getElementById('calcDisplay').value = calcValue;
        }

        function calcCalculate() {
            try {
                const result = eval(calcValue);
                document.getElementById('calcDisplay').value = result;
                calcValue = result.toString();
            } catch (error) {
                document.getElementById('calcDisplay').value = 'Erro';
                calcValue = '';
            }
        }

        // ======= PRODUTOS =======
        function addProduct() {
            const code = document.getElementById('productCode').value.trim();
            const name = document.getElementById('productName').value.trim();
            const category = document.getElementById('productCategory').value;
            const price = parseFloat(document.getElementById('productPrice').value);
            const unit = document.getElementById('productUnit').value.trim();
            const formula = document.getElementById('productFormula').value.trim();

            if (!code || !name || !price) {
                showNotification('Preencha todos os campos obrigatórios!', 'error');
                return;
            }

            showLoading(true);

            setTimeout(() => {
                const newProduct = {
                    id: currentProductId++,
                    codigo: code,
                    nome: name,
                    preco: price,
                    formula: formula || 'Q * $',
                    unidade: unit || 'UNID'
                };

                if (!catalogoProdutos[category]) {
                    catalogoProdutos[category] = [];
                }

                catalogoProdutos[category].push(newProduct);

                // Limpa formulário
                document.getElementById('productCode').value = '';
                document.getElementById('productName').value = '';
                document.getElementById('productPrice').value = '';
                document.getElementById('productUnit').value = 'UNID';
                document.getElementById('productFormula').value = 'Q * $';

                closeModal('addProductModal');
                showLoading(false);
                showNotification('Produto adicionado com sucesso!', 'success');
                initializeInterface();
            }, 300);
        }

        function exportProducts() {
            showLoading(true);

            setTimeout(() => {
                let csvContent = "codigo,nome,preco,formula,unidade,categoria\n";

                Object.keys(catalogoProdutos).forEach(category => {
                    catalogoProdutos[category].forEach(product => {
                        csvContent += `"${product.codigo}","${product.nome}",${product.preco},"${product.formula}","${product.unidade}","${category}"\n`;
                    });
                });

                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement("a");
                const url = URL.createObjectURL(blob);
                link.setAttribute("href", url);
                link.setAttribute("download", `produtos_exportados_${new Date().toISOString().slice(0, 10)}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                showLoading(false);
                showNotification('Produtos exportados com sucesso!', 'success');
            }, 300);
        }

        function importFromText() {
            const csvContent = document.getElementById('csvContent').value.trim();

            if (!csvContent) {
                showNotification('Por favor, cole o conteúdo CSV!', 'error');
                return;
            }

            showLoading(true);

            setTimeout(() => {
                const lines = csvContent.split('\n');
                let imported = 0;
                let errors = 0;
                const startIndex = lines[0].includes('codigo') ? 1 : 0;

                for (let i = startIndex; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (!line) continue;

                    const values = line.split(',').map(v => v.replace(/"/g, ''));

                    if (values.length >= 6) {
                        const [codigo, nome, preco, formula, unidade, categoria] = values;

                        const newProduct = {
                            id: currentProductId++,
                            codigo: codigo.trim(),
                            nome: nome.trim(),
                            preco: parseFloat(preco) || 0,
                            formula: formula.trim() || 'Q * $',
                            unidade: unidade.trim() || 'UNID'
                        };

                        if (!catalogoProdutos[categoria.trim()]) {
                            catalogoProdutos[categoria.trim()] = [];
                        }

                        catalogoProdutos[categoria.trim()].push(newProduct);
                        imported++;
                    } else {
                        errors++;
                    }
                }

                closeModal('importModal');
                document.getElementById('csvContent').value = '';
                showLoading(false);
                showNotification(`Importação concluída: ${imported} produtos importados, ${errors} erros`, 'info');
                initializeInterface();
            }, 500);
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                showLoading(true);
                const reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('csvContent').value = e.target.result;
                    showLoading(false);
                };
                reader.readAsText(file);
            }
        }

        function resetProducts() {
            if (confirm('Tem certeza que deseja resetar todos os produtos para os padrões? Esta ação não pode ser desfeita!')) {
                showLoading(true);
                setTimeout(() => {
                    location.reload();
                }, 500);
            }
        }

        function filterByCategory() {
            const category = document.getElementById('categoryFilter').value;
            const paginas = document.querySelectorAll('.pagina');

            if (category) {
                // Esconde todas as páginas e mostra apenas a selecionada
                paginas.forEach((pagina, index) => {
                    if (nomesPaginas[index] === category) {
                        pagina.classList.add('ativa');
                        barraInferior.children[index].classList.add('ativo');
                    } else {
                        pagina.classList.remove('ativa');
                        barraInferior.children[index].classList.remove('ativo');
                    }
                });
                showNotification(`Filtrando por: ${category}`, 'info');
            } else {
                // Mostra a primeira página
                paginas.forEach((pagina, index) => {
                    pagina.classList.toggle('ativa', index === 0);
                    barraInferior.children[index].classList.toggle('ativo', index === 0);
                });
                showNotification('Mostrando todas as categorias', 'info');
            }
        }

function searchProducts() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    document.getElementById('categoryFilter').value = '';

    const allRows = document.querySelectorAll('.planilha tbody tr');
    let visibleCount = 0;

    allRows.forEach(row => {
        const nomeProduto = row.cells[2]?.textContent.toLowerCase() || '';
        const match = nomeProduto.includes(searchTerm);
        row.style.display = match ? '' : 'none';
        if (match) visibleCount++;
    });

    const paginas = document.querySelectorAll('.pagina');
    const botoes = document.querySelectorAll('.barra-inferior button');

    // Remove todas as classes ativas
    paginas.forEach(p => p.classList.remove('ativa'));
    botoes.forEach(b => b.classList.remove('ativo'));

    // Ativa apenas a primeira aba que tem resultados visíveis
    let abaAtivada = false;
    paginas.forEach((pagina, index) => {
        const temVisivel = Array.from(pagina.querySelectorAll('tbody tr')).some(tr => tr.style.display !== 'none');
        if (temVisivel && !abaAtivada) {
            pagina.classList.add('ativa');
            botoes[index].classList.add('ativo');
            abaAtivada = true;
        }
    });

    // Se nenhuma aba tem resultados, ativa a primeira (CLIENTE)
    if (!abaAtivada) {
        paginas[0].classList.add('ativa');
        botoes[0].classList.add('ativo');
    }

    if (searchTerm) {
        showNotification(`Encontrados ${visibleCount} produtos com: "${searchTerm}"`, 'info');
    } else {
        showNotification('Busca limpa. Mostrando primeira aba com resultados.', 'info');
    }
}

        // ======= FUNÇÕES DE INTERFACE =======
        function criarLinhaProduto(prod) {
            return `
                <tr data-formula="${prod.formula || 'Q * $'}" data-product-id="${prod.id}">
                    <td class="col-clonar">
                        <button class="btn-clone" title="Clonar produto" onclick="clonarLinha(this)">
                            <i class="fas fa-copy"></i>
                        </button>
                    </td>
                    <td style="font-size: 14px;">${prod.codigo}</td>
                    <td style="font-size: 14px;">${prod.nome}</td>
                    <td style="opacity: 100%; font-size: 0px;" class="preco-base">${prod.preco.toFixed(2).replace('.', ',')}</td>
                    <td><input type="text" class="descricao" placeholder="Digite a descrição"></td>
                    <td style="font-size: 14px;">${prod.unidade || ''}</td>
                    <td style="font-size: 14px;"><input type="number" class="largura" min="0" step="1" value="0"></td>
                    <td style="font-size: 14px;"><input type="number" class="comprimento" min="0" step="1" value="0"></td>
                    <td style="font-size: 14px;"><input type="number" class="quantidade" min="0" step="1" value="0"></td>
                    <td style="font-size: 14px;" class="valor-total">0,00</td>
                </tr>
            `;
        }

        function criarTabela(categoria) {
            const produtos = catalogoProdutos[categoria] || [];
            let linhas = '';

            produtos.forEach(prod => {
                linhas += criarLinhaProduto(prod);
            });

            return `
                <table class="planilha" style="width: 74.5%; height: 8px; position: absolute; left: -5%;">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Código</th>
                            <th>Nome</th>
                            <th style="opacity: 100%; font-size: 0px;">Preço</th>
                            <th>Desc</th>
                            <th>Medida</th>
                            <th>Largura</th>
                            <th>Compr</th>
                            <th>Quant</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${linhas}
                    </tbody>
                </table>
            `;
        }

        function criarPaginaCliente() {
            return `
                <table class="planilha" style="margin-top: 30px; position: absolute; left: -1.5%;>
                    <tbody>
                        <tr><td><i class="fas fa-user"></i> CLIENTE</td><td colspan="8"><input id="cliente_nome" type="text" style="width:98%" placeholder="Nome do cliente"></td></tr>
                        <tr><td><i class="fas fa-map-marker-alt"></i> ENDEREÇO</td><td colspan="8"><input id="cliente_endereco" type="text" style="width:98%" placeholder="Endereço completo"></td></tr>
                        <tr><td><i class="fas fa-phone"></i> TELEFONE</td><td colspan="8"><input id="cliente_telefone" type="text" style="width:98%" placeholder="(00) 00000-0000"></td></tr>
                        <tr><td><i class="fas fa-calendar"></i> DATA</td><td colspan="8"><input id="cliente_data" type="text" style="width:98%" placeholder="DD/MM/AAAA"></td></tr>
                        <tr><td><i class="fas fa-tools"></i> SERVIÇO</td><td colspan="8"><input id="cliente_servico" type="text" style="width:98%" placeholder="Descrição do serviço"></td></tr>
                        <tr><td><i class="fas fa-user-tie"></i> FUNCIONÁRIO</td><td colspan="8"><input id="cliente_funcionario" type="text" style="width:98%" placeholder="Nome do funcionário"></td></tr>
                        <tr><td><i class="fas fa-hashtag"></i> Nº</td><td colspan="8"><input id="cliente_numero" type="text" style="width:98%" placeholder="Número do orçamento"></td></tr>
                    </tbody>
                </table>
            `;
        }
        // ✅ ADICIONADO: Verificações de segurança
        function initializeInterface() {
            console.log('📊 Inicializando interface...');

            const paginasContainer = document.getElementById("paginas-container");
            const barraInferior = document.getElementById("barra-inferior");

            if (!paginasContainer || !barraInferior) {
                console.error('❌ Elementos principais não encontrados');
                showNotification('Erro: Elementos da página não encontrados', 'error');
                return;
            }

            showLoading(true);

            // ======================  AGORA DENTRO DO SETTIMEOUT  ======================
            setTimeout(() => {
                paginasContainer.innerHTML = '';
                barraInferior.innerHTML = '';

                nomesPaginas.forEach((nome, index) => {
                    const pagina = document.createElement("div");
                    pagina.className = "pagina" + (index === 0 ? " ativa" : "");

                    if (nome === "CLIENTE") {
                        pagina.innerHTML = criarPaginaCliente() +
                            `<div id="info-cliente-flutuante" class="info-cliente-box">
       <div class="info-cliente-titulo">USAR</div>
       <div id="info-cliente-valor" class="info-cliente-valor">"." no lugar de "/"</div>
     </div>`;
                    } else if (nome === "TOTAL GERAL") {
                        pagina.innerHTML = `
                    <table class="planilha" id="tabela-total-geral">
                        <thead>
                            <tr><th><i class="fas fa-list"></i> Categoria</th><th><i class="fas fa-dollar-sign"></i> Total (R$)</th></tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                    <table class="planilha" id="tabela-extra">
                        <tr>
                            <td class="rotacionado"><i class="fas fa-calculator"></i> TOTAL</td>
                            <td></td>
                            <td><i class="fas fa-credit-card"></i> PIX</td>
                            <td><i class="fas fa-money-check"></i> CHEQUE</td>
                            <td><i class="fas fa-money-bill"></i> DINHEIRO</td>
                            <td><i class="fas fa-credit-card"></i> CARTÃO</td>
                            <td><i class="fas fa-calculator"></i> V. TOTAL</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>A VISTA</td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td id="linha2"></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>ENTRADA</td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td id="linha3"></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>A PRAZO</td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td id="linha4"></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>PARCELAS</td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td class="clicavel"></td>
                            <td id="linha5"></td>
                        </tr>
                    </table>
                `;
                    } else if (nome === "ESTRUTURA METALICA") {
                        pagina.innerHTML = criarTabela(nome) +
                            `<div id="rebites-flutuante" class="rebites-box">
                   <div class="rebites-titulo">REBITES</div>
                   <div id="rebites-valor" class="rebites-valor">0,00</div>
                 </div>
                 <div id="eletrodos-flutuante" class="eletrodos-box">
                   <div class="eletrodos-titulo">ELETRODOS</div>
                   <div id="eletrodos-valor" class="eletrodos-valor">0,00</div>
                 </div>`;
                    } else if (nome === "MÃO DE OBRA") {
                        pagina.innerHTML = criarTabela(nome) +
                            `<div id="tempo-pp-flutuante" class="tempo-pp-box">
       <div class="tempo-pp-titulo">PRODUÇÃO ESTRADA</div>
       <div id="tempo-pp-valor" class="tempo-pp-valor">colocar 1</div>
     </div>`;
                    } else if (nome === "ORÇAMENTO") {
                        pagina.innerHTML = `
                    <table class="planilha" style="margin-bottom:20px;">
                        <tbody>
                            <tr><td><i class="fas fa-user"></i> CLIENTE</td><td colspan="3"><input id="orc_cliente_nome" type="text" style="width:98%" readonly></td></tr>
                            <tr><td><i class="fas fa-map-marker-alt"></i> ENDEREÇO</td><td colspan="3"><input id="orc_cliente_endereco" type="text" style="width:98%" readonly></td></tr>
                            <tr><td><i class="fas fa-phone"></i> TELEFONE</td><td colspan="3"><input id="orc_cliente_telefone" type="text" style="width:98%" readonly></td></tr>
                            <tr><td><i class="fas fa-calendar"></i> DATA</td><td colspan="3"><input id="orc_cliente_data" type="text" style="width:98%" readonly></td></tr>
                            <tr><td><i class="fas fa-tools"></i> SERVIÇO</td><td colspan="3"><input id="orc_cliente_servico" type="text" style="width:98%" readonly></td></tr>
                            <tr><td><i class="fas fa-user-tie"></i> FUNCIONÁRIO</td><td colspan="3"><input id="orc_cliente_funcionario" type="text" style="width:98%" readonly></td></tr>
                            <tr><td><i class="fas fa-hashtag"></i> Nº</td><td colspan="3"><input id="orc_cliente_numero" type="text" style="width:98%" readonly></td></tr>
                        </tbody>
                    </table>
                    <div class="orcamento-container">
                        <table class="planilha orcamento-coluna" id="orcamento-coluna1">
                            <thead>
                                <tr class="categoriaPROD">
                                    <th>Produto</th>
                                    <th>Código</th>
                                    <th>Qtd</th>
                                    <th>Unid</th>
                                    <th>Valor</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                `;
                    } else {
                        pagina.innerHTML = criarTabela(nome);
                    }

                    paginasContainer.appendChild(pagina);

                    const btn = document.createElement("button");
                    btn.textContent = nome;
                    if (index === 0) btn.classList.add("ativo");
                    btn.addEventListener("click", () => mudarPagina(index));
                    barraInferior.appendChild(btn);
                });

                calcularValores();
                monitorarInputs();
                updateCategoryFilter();
                showLoading(false);

                // ======================  AGORA SIM, MUDE A PÁGINA  ======================
                mudarPagina(0);
            }, 300);
        }

        function mudarPagina(indice) {
            const paginas = document.querySelectorAll('.pagina');
            const botoes = document.querySelectorAll('.barra-inferior button');

            paginas.forEach((p, i) => {
                const ativa = i === indice;
                p.classList.toggle('ativa', ativa);
                botoes[i].classList.toggle('ativo', ativa);
            });

            const mostrarRebitesEletrodos = nomesPaginas[indice] === 'ESTRUTURA METALICA';
            const mostrarTempoPP = nomesPaginas[indice] === 'MÃO DE OBRA';
            const mostrarInfoCliente = nomesPaginas[indice] === 'CLIENTE';



            const r = document.getElementById('rebites-flutuante');
            const e = document.getElementById('eletrodos-flutuante');
            const t = document.getElementById('tempo-pp-flutuante');
            const c = document.getElementById('info-cliente-flutuante');

            if (r) r.style.display = mostrarRebitesEletrodos ? 'block' : 'none';
            if (e) e.style.display = mostrarRebitesEletrodos ? 'block' : 'none';
            if (t) t.style.display = mostrarTempoPP ? 'block' : 'none';
            if (c) c.style.display = mostrarInfoCliente ? 'block' : 'none';
        }


        function sincronizarClienteParaOrcamento() {
            const campos = ["nome", "endereco", "telefone", "data", "servico", "funcionario", "numero"];
            campos.forEach(campo => {
                const origem = document.getElementById(`cliente_${campo}`);
                const destino = document.getElementById(`orc_cliente_${campo}`);
                if (origem && destino) destino.value = origem.value;
            });
        }

        function atualizarOrcamento() {
            const tbody = document.querySelector("#orcamento-coluna1 tbody");
            if (!tbody) {
                console.warn("⚠️ Tabela de orçamento não encontrada");
                return;
            }

            tbody.innerHTML = '';

            let totalOrcamento = 0;
            const items = [];

            document.querySelectorAll('.planilha tbody tr').forEach(linha => {
                const codigo = linha.cells[1]?.textContent.trim();
                const nome = linha.cells[2]?.textContent.trim();
                const unidade = linha.cells[5]?.textContent.trim() || "";
                const quantidade = parseFloat(linha.querySelector(".quantidade")?.value) || 0;
                const valorTotal = parseFloat(linha.querySelector(".valor-total")?.textContent.replace(',', '.')) || 0;

                if (quantidade > 0) {
                    items.push({ codigo, nome, quantidade, unidade, valorTotal });
                    totalOrcamento += valorTotal;
                }
            });

            items.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
            <td>${item.codigo}</td>
            <td>${item.nome}</td>
            <td>${item.quantidade}</td>
            <td>${item.unidade}</td>
            <td>R$ ${item.valorTotal.toFixed(2).replace('.', ',')}</td>
        `;
                tbody.appendChild(row);
            });

            const imposto = totalOrcamento * 0.1057;
            const totalComImposto = totalOrcamento + imposto;

            // Linha de imposto
            const impostoRow = document.createElement('tr');
            impostoRow.style.background = 'linear-gradient(45deg, #fff2c7, #ffeaa7)';
            impostoRow.innerHTML = `
        <td></td>
        <td><strong><i class="fas fa-receipt"></i> IMPOSTO</strong></td>
        <td>1</td>
        <td></td>
        <td><strong>R$ ${imposto.toFixed(2).replace('.', ',')}</strong></td>
    `;
            tbody.appendChild(impostoRow);

            // Linha total
            const totalRow = document.createElement('tr');
            totalRow.style.background = 'linear-gradient(45deg, #d4edda, #c3e6cb)';
            totalRow.style.fontWeight = 'bold';
            totalRow.innerHTML = `
        <td></td>
        <td colspan="3" style="text-align:right;"><i class="fas fa-calculator"></i> TOTAL:</td>
        <td>R$ ${totalComImposto.toFixed(2).replace('.', ',')}</td>
    `;
            tbody.appendChild(totalRow);
        }

        function calcularValores() {
            document.querySelectorAll(".planilha").forEach(tabela => {
                const mapa = {};
                tabela.querySelectorAll("tbody tr").forEach(linha => {
                    const codigo = linha.cells[1]?.textContent.trim();
                    if (!codigo) return;
                    const largura = parseFloat(linha.querySelector(".largura")?.value) || 0;
                    const comprimento = parseFloat(linha.querySelector(".comprimento")?.value) || 0;
                    const quantidade = parseFloat(linha.querySelector(".quantidade")?.value) || 0;
                    mapa[codigo] = { C: comprimento, A: largura, Q: quantidade };
                });

                tabela.querySelectorAll("tbody tr").forEach(linha => {
                    if (linha.querySelector(".preco-base")) {
                        const precoBaseText = linha.querySelector(".preco-base").textContent.replace(',', '.');
                        const precoBase = parseFloat(precoBaseText) || 0;
                        const comprimento = parseFloat(linha.querySelector(".comprimento")?.value) || 0;
                        const largura = parseFloat(linha.querySelector(".largura")?.value) || 0;
                        const quantidade = parseFloat(linha.querySelector(".quantidade")?.value) || 0;
                        let valorTotal = 0;
                        const formula = linha.getAttribute("data-formula");

                        if (formula && formula.trim() !== "") {
                            let expr = formula
                                .replace(/\$/g, precoBase.toString())
                                .replace(/\bQ\b(?!\[)/g, quantidade.toString())
                                .replace(/\bA\b(?!\[)/g, largura.toString())
                                .replace(/\bC\b(?!\[)/g, comprimento.toString());

                            expr = expr.replace(/C\[(\d+)\]/g, (_, cod) => {
                                const v = mapa[cod];
                                return v ? v.C.toString() : '0';
                            });
                            expr = expr.replace(/A\[(\d+)\]/g, (_, cod) => {
                                const v = mapa[cod];
                                return v ? v.A.toString() : '0';
                            });
                            expr = expr.replace(/Q\[(\d+)\]/g, (_, cod) => {
                                const v = mapa[cod];
                                return v ? v.Q.toString() : '0';
                            });

                            try {
                                valorTotal = eval(expr);
                            } catch (e) {
                                console.error("Erro na fórmula:", formula, expr, e);
                                valorTotal = 0;
                            }
                        }

                        const tdValorTotal = linha.querySelector(".valor-total");
                        if (tdValorTotal) {
                            tdValorTotal.textContent = valorTotal.toFixed(2).replace('.', ',');
                        }
                    }
                });
            });

            calcularRebites();
            calcularEletrodos();
            atualizarTotalGeral();
            atualizarOrcamento();
        }

        function calcularRebites() {
            const mapa = {};
            document.querySelectorAll('.pagina').forEach((pagina, idx) => {
                if (nomesPaginas[idx] !== 'ESTRUTURA METALICA') return;

                pagina.querySelectorAll('tbody tr').forEach(linha => {
                    const cod = String(linha.cells[1]?.textContent.trim());
                    const C = parseFloat(linha.querySelector('.comprimento')?.value) || 0;
                    const A = parseFloat(linha.querySelector('.largura')?.value) || 0;
                    const Q = parseFloat(linha.querySelector('.quantidade')?.value) || 0;
                    if (cod) mapa[cod] = { C, A, Q };
                });
            });

            const get = (cod) => {
                const v = mapa[cod];
                return v ? (v.C + v.C + v.A + v.A) * v.Q * 6 : 0;
            };

            const total =
                get('26013884') + // CA
                get('2600881') + // RA
                get('43588') + // IO
                get('26013870') + // DE
                get('26013869') + // CON
                get('26013868') + // TA
                get('2601387') + // DOS
                get('2601158') + // IN
                get('765') + // FER
                get('26013867') + // NO
                get('26013866') + // GRAN
                get('26013865') + // DE
                get('2601209') + // PRA
                get('426') + // CA
                get('2601023') + // CE
                get('26013871');  // TE

            document.getElementById('rebites-valor').textContent = '>.< ' + total.toFixed(2).replace('.', ',');
        }

        function calcularEletrodos() {
            const mapa = {};
            document.querySelectorAll('.pagina').forEach((pagina, idx) => {
                if (nomesPaginas[idx] !== 'ESTRUTURA METALICA') return;

                pagina.querySelectorAll('tbody tr').forEach(linha => {
                    const cod = String(linha.cells[1]?.textContent.trim());
                    const Q = parseFloat(linha.querySelector('.quantidade')?.value) || 0;
                    if (cod) mapa[cod] = Q;
                });
            });

            const get = (cod, mult = 2) => (mapa[cod] || 0) * mult;

            const total =
                get('43326') +       // MEU
                get('2601219') +     // DE
                get('26013888') +    // US
                get('26013889') +    // MEU
                get('26013890') +    // SE
                get('43437') +       // NHOR
                get('26013871', 4) + // MI
                get('2601023', 4) +  // AJU
                get('426', 4) +      // DA
                get('2601209', 4) +  // POR
                get('26013865', 4) + // FA
                get('26013866', 4) + // VOR
                get('26013867', 4) + // E
                get('765', 4) +      // NA
                get('2601158', 4) +  // ES
                get('26013872', 4) + // CO
                get('26013868', 4) + // NO
                get('26013869', 4) + // TRA
                get('26013870', 4) + // BA
                get('43588', 4) +    // LHO
                get('2600881', 4) +  // OU
                get('26013884', 4) + // FA
                get('26013882', 2) + // CU
                get('26013873', 2) + // DA
                get('26013874', 2) + // DE
                get('26013879', 2) + // ES
                get('26013875', 2) + // TOU
                get('26013876', 2) + // VI
                get('26013880', 2) + // CI
                get('26013877', 2) + // ADO
                get('26013878', 2) + // NO
                get('26013883', 2) + // ZAP
                get('26013885', 2) + // INS
                get('26013886', 2) + // TA
                get('26013887', 2) + // ENO
                get('26013892', 2) + // FACE
                get('43848');        // BOOK

            document.getElementById('eletrodos-valor').textContent = '>.< ' + total.toFixed(2).replace('.', ',');
        }

        function monitorarInputs() {
            document.querySelectorAll(".largura, .comprimento, .quantidade").forEach(input => {
                input.addEventListener("input", calcularValores);
            });
        }

        function updateCategoryFilter() {
            const categoryFilter = document.getElementById('categoryFilter');
            categoryFilter.innerHTML = '<option value="">Todas</option>';

            Object.keys(catalogoProdutos).forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                categoryFilter.appendChild(option);
            });
        }

        // ❌ FALTAVA: Fechamento correto da função atualizarTotalGeral()
        function atualizarTotalGeral() {
            const categorias = Object.keys(catalogoProdutos);
            const tabelaGeral = document.querySelector("#tabela-total-geral tbody");
            if (!tabelaGeral) return; // ← CORRIGIDO: return ao invés de return;

            tabelaGeral.innerHTML = ""; // ← CORRIGIDO: removido o 't' extra
            let somaGeral = 0;

            // ... resto do código
            categorias.forEach(cat => {
                const indice = nomesPaginas.indexOf(cat);
                if (indice >= 0) {
                    const pagina = document.querySelectorAll('.pagina')[indice];
                    const valores = pagina.querySelectorAll(".valor-total");
                    let soma = 0;
                    valores.forEach(v => soma += parseFloat(v.textContent.replace(',', '.')) || 0);
                    somaGeral += soma;
                    tabelaGeral.innerHTML += `<tr><td><i class="fas fa-folder"></i> ${cat}</td><td>R$ ${soma.toFixed(2).replace('.', ',')}</td></tr>`;
                }
            });

            const imposto = somaGeral * 0.1057;
            tabelaGeral.innerHTML += `<tr style="background: linear-gradient(45deg, #fff2c7, #ffeaa7);">
            <td><strong><i class="fas fa-receipt"></i> IMPOSTO</strong></td>
            <td><strong>R$ ${imposto.toFixed(2).replace('.', ',')}</strong></td>
        </tr>`;
            const totalComImposto = somaGeral + imposto;

            document.getElementById("linha2").textContent = "R$ " + totalComImposto.toFixed(2).replace('.', ',');
            document.getElementById("linha3").textContent = "R$ " + ((totalComImposto * 0.05 + totalComImposto) / 4).toFixed(2).replace('.', ',');
            document.getElementById("linha4").textContent = "R$ " + (totalComImposto * 0.05 + totalComImposto).toFixed(2).replace('.', ',');
            document.getElementById("linha5").textContent = "R$ " + ((totalComImposto * 0.05 + totalComImposto) / 4).toFixed(2).replace('.', ',');
        }

        /* ----------  SALVA DIRETO EM C:\Users\As informática\Downloads\orçamentos  ---------- */
        /* ----------  SALVAR PEDINDO PASTA E VERSÃO  ---------- */
        async function salvarNaPastaOrcamentos(blob, nomeArquivo) {
            /* 1. Escolhe a pasta (sempre) */
            let dirHandle;
            try {
                dirHandle = await window.showDirectoryPicker({ startIn: 'downloads' });
            } catch (err) {
                if (err.name === 'AbortError') {
                    showNotification('❌ Você cancelou a escolha da pasta.', 'warning', 3000);
                } else {
                    showNotification('❌ Erro ao escolher pasta: ' + err.message, 'error', 3000);
                }
                return;
            }

            /* 2. Normaliza o nome base para comparação */
            const ext = nomeArquivo.match(/(\.\w+)$/)?.[1] || '';
            const base = nomeArquivo.replace(/(\s*\(\d+\))?(\.\w+)?$/i, ''); // remove (n) e extensão
            const normaliza = (s) => s.toLowerCase().replace(/\s+/g, '');

            /* 3. Lista arquivos existentes e busca “parecidos” */
            const arqs = [];
            for await (const [nome, handle] of dirHandle.entries()) {
                if (handle.kind === 'file') arqs.push(nome);
            }

            const parecidos = arqs.filter(n =>
                normaliza(n.replace(/(\s*\(\d+\))?(\.\w+)?$/i, '')) === normaliza(base)
            );

            /* 4. Decide o nome final */
            let nomeFinal = nomeArquivo;

            if (parecidos.length) {
                // Pergunta o que fazer
                const querSubstituir = confirm(
                    `Já existe um arquivo com nome parecido: “${parecidos[0]}”.\n\n` +
                    `Clique em “OK” para SUBSTITUIR ou em “Cancelar” para criar uma nova versão.`
                );

                if (!querSubstituir) {
                    // Criar nova versão com próximo (n)
                    const nums = parecidos
                        .map(n => Number(n.match(/\((\d+)\)/)?.[1]) || 0)
                        .sort((a, b) => b - a);
                    const prox = (nums[0] || 0) + 1;
                    nomeFinal = `${base} (${prox})${ext}`;
                } else {
                    nomeFinal = parecidos[0]; // mantém o nome exato para sobrescrever
                }
            }

            /* 5. Grava o arquivo */
            try {
                const handle = await dirHandle.getFileHandle(nomeFinal, { create: true });
                const writable = await handle.createWritable();
                await writable.write(blob);
                await writable.close();
                showNotification(`✅ Salvo como “${nomeFinal}”`, 'success', 3000);
            } catch (err) {
                showNotification('❌ Erro ao salvar: ' + err.message, 'error', 3000);
            }
        }

        function showNotification(msg, tipo = 'info', tempoMs = 0) {
            const box = document.createElement('div');
            box.className = `notif notif--${tipo}`;

            // Adiciona o texto
            const texto = document.createElement('span');
            texto.textContent = msg;
            box.appendChild(texto);

            // Adiciona botão de fechar
            const btnClose = document.createElement('button');
            btnClose.className = 'notif__close';
            btnClose.innerHTML = '×';
            btnClose.onclick = () => closeNotif(box);
            box.appendChild(btnClose);

            document.body.appendChild(box);

            // Força reflow para animar
            box.offsetHeight;
            box.classList.add('notif--show');

            // Fecha automaticamente se tempo foi passado
            if (tempoMs > 0) {
                setTimeout(() => closeNotif(box), tempoMs);
            }
        }

        function closeNotif(el) {
            el.classList.remove('notif--show');
            el.addEventListener('transitionend', () => el.remove(), { once: true });
        }

        // ======= FUNÇÕES DE ARQUIVO =======
        async function exportarExcelCompleto() {
            /* ---------- DADOS DO CLIENTE (com CORREÇÃO do nome) ---------- */
            const cliente = {
                nome: document.getElementById('cliente_nome')?.value || '',
                endereco: document.getElementById('cliente_endereco')?.value || '',
                telefone: document.getElementById('cliente_telefone')?.value || '',
                data: document.getElementById('cliente_data')?.value || '',
                servico: document.getElementById('cliente_servico')?.value || '',
                numero: document.getElementById('cliente_numero')?.value || '',
                funcionario: document.getElementById('cliente_funcionario')?.value || ''
            };

            /* ---------- PRODUTOS COM QUANTIDADE > 0 (inclui clonados) ---------- */
            const produtos = [];
            let subTotal = 0;

            // Percorre TODAS as tabelas de produtos
            document.querySelectorAll('.planilha tbody tr').forEach(tr => {
                const Q = parseFloat(tr.querySelector('.quantidade')?.value) || 0;
                if (Q <= 0) return;

                const cod = tr.cells[1]?.textContent.trim();
                const descr = tr.cells[2]?.textContent.trim();
                const pl = tr.cells[0]?.textContent.trim();
                const unid = tr.cells[5]?.textContent.trim();
                const comp = tr.querySelector('.comprimento')?.value || 0;
                const alt = tr.querySelector('.largura')?.value || 0;
                const vlr = parseFloat(tr.querySelector('.valor-total')?.textContent.replace(',', '.')) || 0;

                produtos.push([cod, descr, unid, comp, alt, Q, vlr.toFixed(2).replace('.', ',')]);
                subTotal += vlr;
            });

            const imposto = subTotal * 0.1057;
            const total = subTotal + imposto;
            const aVista = total.toFixed(2).replace('.', ',');
            const entrada = (total * 1.05 * 0.25).toFixed(2).replace('.', ',');
            const aPrazo = (total * 1.05).toFixed(2).replace('.', ',');
            const parcela = (total * 1.05 + total / 4).toFixed(2).replace('.', ',');

            /* ---------- MONTAGEM DO EXCEL ---------- */
            const linhas = [
                ['CLIENTE', cliente.nome, '', '', '', '', 'FUNCIONÁRIO', cliente.funcionario],
                ['END.:', cliente.endereco],
                ['TEL.:', cliente.telefone, '', '', '', '', 'DATA', cliente.data],
                ['SERVIÇO:', cliente.servico, '', '', '', '', 'NOTA Nº',],
                [],
                ['TIPO DE PAGAMENTO', '', 'PIX ⬜', 'DINHEIRO ⬜', '', 'CHEQUE ⬜', '', 'CARTÃO ⬜'],
                [],
                ['FUNCIONÁRIOS ENVOLVIDOS:'],
                []

            ];
            /* ----------  CABEÇALHO DOURADO DOS PRODUTOS  ---------- */
            const headerRow = ['CODIGO', 'PRODUTO', 'MEDIDA', 'COMPRIMENTO', 'LARGURA', 'QUANTIDADE', 'VALOR'];
            linhas.push(headerRow);

            /* ---------- INSERE PRODUTOS ---------- */
            produtos.forEach(p => linhas.push(p));

            /* ---------- PREENCHE ATÉ LINHA 38 (índice 38) ---------- */
            while (linhas.length < 38) linhas.push([]);

            /* ---------- BLOCO DE TOTAIS (a partir da linha 39) ---------- */
            linhas.push(['', 'IMPOSTO', '', '', '', '', '', `R$ ${imposto.toFixed(2).replace('.', ',')}`]);
            linhas.push([]);
            linhas.push(['', '', 'PIX', 'CHEQUE', 'DINHEIRO', 'CARTÃO', '', 'V.TOTAL']);
            linhas.push(['', 'A VISTA', '', '', '', '', '', `R$ ${aVista}`]);
            linhas.push(['', 'ENTRADA', '', '', '', '', '', `R$ ${entrada}`]);
            linhas.push(['', 'A PRAZO', '', '', '', '', '', `R$ ${aPrazo}`]);
            linhas.push(['', 'PARCELAs', '', '', '', '', '', `R$ ${entrada}`]);

            /* ---------- GERA ARQUIVO ---------- */
            const ws = XLSX.utils.aoa_to_sheet(linhas);
            // ---------- CABEÇALHO SIMPLES (linha 100) ----------
            const cabecalhoSimples = [
                ['CLIENTE', cliente.nome],
                ['ENDEREÇO', cliente.endereco],
                ['TELEFONE', cliente.telefone],
                ['DATA', cliente.data],
                ['SERVIÇO', cliente.servico],
                ['FUNCIONÁRIO', cliente.funcionario],
                ['Nº', cliente.numero]
            ];
            XLSX.utils.sheet_add_aoa(ws, cabecalhoSimples, { origin: 'A100' });
            // ----------------------------------------------------
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Orçamento');
            const buffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
            const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
            const fileName = `ORÇAMENTO_${cliente.nome}_${cliente.servico}_${cliente.data}`
                .replace(/\s+/g, '_') + '.xlsx';
            await salvarNaPastaOrcamentos(blob, fileName);
        }



        // ======= FUNÇÃO DE IMPRESSÃO =======
        async function imprimirExcelCompleto() {
            /* ---------- DADOS DO CLIENTE ---------- */
            const cliente = {
                nome: document.getElementById('cliente_nome')?.value || '',
                endereco: document.getElementById('cliente_endereco')?.value || '',
                telefone: document.getElementById('cliente_telefone')?.value || '',
                data: document.getElementById('cliente_data')?.value || '',
                servico: document.getElementById('cliente_servico')?.value || '',
                numero: document.getElementById('cliente_numero')?.value || '',
                funcionario: document.getElementById('cliente_funcionario')?.value || ''
            };

            /* ---------- PRODUTOS ---------- */
            const produtos = [];
            let subTotal = 0;
            document.querySelectorAll('.planilha tbody tr').forEach(tr => {
                const Q = parseFloat(tr.querySelector('.quantidade')?.value) || 0;
                if (Q <= 0) return;

                const cod = tr.cells[1]?.textContent.trim();
                const descr = tr.cells[2]?.textContent.trim();
                const pl = tr.cells[0]?.textContent.trim();
                const unid = tr.cells[5]?.textContent.trim();
                const comp = tr.querySelector('.comprimento')?.value || 0;
                const alt = tr.querySelector('.largura')?.value || 0;
                const vlr = parseFloat(tr.querySelector('.valor-total')?.textContent.replace(',', '.')) || 0;

                produtos.push([cod, descr, pl, pl, unid, comp, alt, Q, vlr.toFixed(2).replace('.', ',')]);
                subTotal += vlr;
            });

            const imposto = subTotal * 0.1057;
            const total = subTotal + imposto;
            const aVista = total.toFixed(2).replace('.', ',');
            const entrada = (total * 1.05 * 0.25).toFixed(2).replace('.', ',');
            const aPrazo = (total * 1.05).toFixed(2).replace('.', ',');
            const parcela = (total * 1.05 * 1.05 / 4).toFixed(2).replace('.', ',');

            /* ---------- EXCELJS ---------- */
            const wb = new ExcelJS.Workbook();
            const ws = wb.addWorksheet('Orçamento');

            /* ---------- ESTILOS REUTILIZÁVEIS ---------- */
            const douradoCell = {
                fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFFFD700' } },
            };

            const pastelCell = {
                fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFF8AF' } },
            };

            const peleCell = {
                fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFEEC8' } }
            };
            const greenCell = {
                fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF00FF00' } }
            };
            const blueCell = {
                fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF0000FF' } }
            };
            const cinzaescuroCell = {
                fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'bfddf3' } }
            };
            const cinzaclaroCell = {
                fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFFFFF' } }
            };

            const cinzactCell = {
                fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFFFFF' } }
            };

            const cinzaetCell = {
                fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'bfddf3' } }
            };

            /* ---------- MONTAGEM DA PLANILHA ---------- */
            ws.addRow([]);
            ws.addRow(['CLIENTE', cliente.nome, '', '', '', 'FUNCIONÁRIO', '', cliente.funcionario]);
            ws.addRow(['END.:', cliente.endereco]);
            ws.addRow(['TEL.:', cliente.telefone, '', '', '', '', 'DATA', cliente.data]);
            ws.addRow(['SERVIÇO:', cliente.servico, '', '', '', '', 'NOTA Nº', cliente.numero]);
            ws.addRow([]);
            ws.addRow(['        .PAGAMENTO:', '', 'PIX ⬜', 'DINHEIRO ⬜', '', 'CHEQUE ⬜', '', 'CARTÃO ⬜']);
            ws.addRow([]);
            ws.addRow(['FUNCIONÁRIOS ENVOLVIDOS:']);
            ws.addRow([]);

            /* ---------- CABEÇALHO DOURADO ---------- */
            const headerRow = ['COD', '', 'MATERIAL', '', 'UNID', 'COMP', 'ALTURA', 'QUANT', 'V. TOTAL'];
            ws.addRow(headerRow);

            /* ---------- PRODUTOS ---------- */
            produtos.forEach(p => ws.addRow(p));

            /* ---------- PREENCHE ATÉ LINHA 38 ---------- */
            while (ws.rowCount < 38) ws.addRow([]);

            /* ---------- TOTAIS ---------- */
            ws.addRow(['', 'IMPOSTO', '', '', '', '', `R$ ${imposto.toFixed(2).replace('.', ',')}`]);
            ws.addRow([]);
            ws.addRow(['', '', 'PIX', 'CHEQUE', 'DINHEIRO', 'CARTÃO', 'V.TOTAL']);
            ws.addRow(['', 'A VISTA', '', '', '', '', `R$ ${aVista}`]);
            ws.addRow(['', 'ENTRADA', '', '', '', '', `R$ ${entrada}`]);
            ws.addRow(['', 'A PRAZO', '', '', '', '', `R$ ${aPrazo}`]);
            ws.addRow(['', 'PARCELAs', '', '', '', '', `R$ ${parcela}`]);

            /* ---------- CABEÇALHO SIMPLES (A100) ---------- */
            const simple = [
                ['CLIENTE', cliente.nome],
                ['ENDEREÇO', cliente.endereco],
                ['TELEFONE', cliente.telefone],
                ['DATA', cliente.data],
                ['SERVIÇO', cliente.servico],
                ['FUNCIONÁRIO', cliente.funcionario],
                ['Nº', cliente.numero]
            ];
            simple.forEach((row, i) => {
                ws.getCell(100 + i, 1).value = row[0];
                ws.getCell(100 + i, 2).value = row[1];
            });

            const movimentos = [

                // recortar celulas de C10 a C37                
                { de: 'C10', para: 'L10' }, { de: 'C12', para: 'L10' }, { de: 'C13', para: 'L10' },
                { de: 'C14', para: 'L10' }, { de: 'C15', para: 'L10' }, { de: 'C16', para: 'L10' }, { de: 'C17', para: 'L10' },
                { de: 'C18', para: 'L10' }, { de: 'C19', para: 'L10' }, { de: 'C20', para: 'L10' }, { de: 'C21', para: 'L10' },
                { de: 'C22', para: 'L10' }, { de: 'C23', para: 'L10' }, { de: 'C24', para: 'L10' }, { de: 'C25', para: 'L10' },
                { de: 'C26', para: 'L10' }, { de: 'C27', para: 'L10' }, { de: 'C28', para: 'L10' }, { de: 'C29', para: 'L10' },
                { de: 'C30', para: 'L10' }, { de: 'C31', para: 'L10' }, { de: 'C32', para: 'L10' }, { de: 'C33', para: 'L10' },
                { de: 'C34', para: 'L10' }, { de: 'C35', para: 'L10' }, { de: 'C36', para: 'L10' }, { de: 'C37', para: 'L10' },

                // recortar celulas de D10 a D37
                { de: 'D11', para: 'L10' }, { de: 'D12', para: 'L10' }, { de: 'D13', para: 'L10' },
                { de: 'D14', para: 'L10' }, { de: 'D15', para: 'L10' }, { de: 'D16', para: 'L10' },
                { de: 'D17', para: 'L10' }, { de: 'D18', para: 'L10' }, { de: 'D19', para: 'L10' },
                { de: 'D20', para: 'L10' }, { de: 'D21', para: 'L10' }, { de: 'D22', para: 'L10' },
                { de: 'D23', para: 'L10' }, { de: 'D24', para: 'L10' }, { de: 'D25', para: 'L10' },
                { de: 'D26', para: 'L10' }, { de: 'D27', para: 'L10' }, { de: 'D28', para: 'L10' },
                { de: 'D29', para: 'L10' }, { de: 'D30', para: 'L10' }, { de: 'D31', para: 'L10' },
                { de: 'D32', para: 'L10' }, { de: 'D33', para: 'L10' }, { de: 'D34', para: 'L10' },
                { de: 'D35', para: 'L10' }, { de: 'D36', para: 'L10' }, { de: 'D37', para: 'L10' },
                { de: 'H41', para: 'L10' }, { de: 'H42', para: 'L10' }, { de: 'H43', para: 'L10' },
                { de: 'H44', para: 'L10' }, { de: 'H45', para: 'L10' }, { de: 'H39', para: 'L10' },

                // recortar celulas especificas do cabeçalho

                { de: 'C2', para: 'L10' }, { de: 'D2', para: 'L10' }, { de: 'E2', para: 'L10' }, { de: 'B7', para: 'L10' },
                { de: 'C5', para: 'L10' }, { de: 'D5', para: 'L10' }, { de: 'E5', para: 'L10' }, { de: 'F5', para: 'L10' },
                { de: 'C3', para: 'L10' }, { de: 'C4', para: 'L10' }, { de: 'I2', para: 'L10' }, { de: 'G7', para: 'L10' },
                { de: 'E7', para: 'L10' }, { de: 'G2', para: 'L10' }, { de: 'E7', para: 'L10' }, { de: 'B11', para: 'L10' },
            ];

            /* ---------- COPIA/RECORTE MANUAL ---------- */
            function copiarCel(origem, destino, recortar = false) {
                const [o, d] = [ws.getCell(origem), ws.getCell(destino)];
                d.value = o.value;
                d.style = o.style;          // copia preenchimento, bordas, alinhamento...
                d.numFmt = o.numFmt;
                if (recortar) o.value = null; // limpa origem
            }

            /* ---------- EXECUTA OS MOVIMENTOS ---------- */
            movimentos.forEach(({ de, para }) => copiarCel(de, para, true));

            /* ---------- CÉLULAS COLORIDAS ---------- */
            headerRow.forEach((_, i) => ws.getCell(11, i + 1).style = douradoCell);

            for (let row = 12; row <= 38; row++) {
                const style = row % 2 === 0 ? cinzaclaroCell : cinzaescuroCell;
                headerRow.forEach((_, i) => ws.getCell(row, i + 1).style = style);
            }

            ['A', 'B', 'C', 'D', 'E', 'H'].forEach(col =>
                headerRow.forEach((_, i) => ws.getCell(39, i + 1).style = cinzaescuroCell)
            );

            headerRow.forEach((_, i) => ws.getCell(40, i + 1).style = cinzaclaroCell);

            headerRow.forEach((_, i) => ws.getCell(41, i + 1).style = pastelCell);

            headerRow.forEach((_, i) => ws.getCell(42, i + 1).style = peleCell);

            headerRow.forEach((_, i) => ws.getCell(43, i + 1).style = pastelCell);

            headerRow.forEach((_, i) => ws.getCell(44, i + 1).style = peleCell);

            headerRow.forEach((_, i) => ws.getCell(45, i + 1).style = pastelCell);



            function copiarCel(origem, destino, recortar = false) {
                const [o, d] = [ws.getCell(origem), ws.getCell(destino)];
                d.value = o.value;
                d.style = o.style;          // copia preenchimento, bordas, alinhamento...
                d.numFmt = o.numFmt;
                if (recortar) o.value = null; // limpa origem
            }
            /* ---------- ESTILO: APENAS BORDA PRETA ---------- */
            const bordaPretaFUNDO = {
                border: {
                    top: { style: 'thin', color: { argb: 'FFFFFF' } },//SIMA
                    left: { style: 'thin', color: { argb: 'FFFFFF' } },//ESQUERDA
                    bottom: { style: 'thin', color: { argb: '000000' } },//BAIXO
                    right: { style: 'thin', color: { argb: 'FFFFFF' } } //DIREITA
                }
            };

            const bordaPretaFUNDOd = {
                border: {
                    top: { style: 'thin', color: { argb: 'FFFFD700' } },//SIMA
                    left: { style: 'thin', color: { argb: 'FFFFD700' } },//ESQUERDA
                    bottom: { style: 'thin', color: { argb: '000000' } },//BAIXO
                    right: { style: 'thin', color: { argb: 'FFFFD700' } } //DIREITA
                }
            };

            const bordaPretaFUNDOce = {
                border: {
                    top: { style: 'thin', color: { argb: 'bfddf3' } },//SIMA
                    left: { style: 'thin', color: { argb: 'bfddf3' } },//ESQUERDA
                    bottom: { style: 'thin', color: { argb: '000000' } },//BAIXO
                    right: { style: 'thin', color: { argb: 'bfddf3' } } //DIREITA
                }
            };

            const bordaPretaTOPO_FUNDO = {
                border: {
                    top: { style: 'thin', color: { argb: '000000' } },//SIMA
                    left: { style: 'thin', color: { argb: 'FFFFFF' } },//ESQUERDA
                    bottom: { style: 'thin', color: { argb: '000000' } },//BAIXO
                    right: { style: 'thin', color: { argb: 'FFFFFF' } } //DIREITA
                }
            };

            const bordaPretaFINAL_DIREITA = {
                border: {
                    top: { style: 'thin', color: { argb: '000000' } },//SIMA
                    left: { style: 'thin', color: { argb: 'FFFFFF' } },//ESQUERDA
                    bottom: { style: 'thin', color: { argb: '000000' } },//BAIXO
                    right: { style: 'thin', color: { argb: '000000' } } //DIREITA
                }
            };

            const bordaPretaCOMPLETO = {
                border: {
                    top: { style: 'thin', color: { argb: '000000' } },//SIMA
                    left: { style: 'thin', color: { argb: '000000' } },//ESQUERDA
                    bottom: { style: 'thin', color: { argb: '000000' } },//BAIXO
                    right: { style: 'thin', color: { argb: '000000' } } //DIREITA
                }
            };

            const bordaPretaFINAL_ESQUERDA = {
                border: {
                    top: { style: 'thin', color: { argb: '000000' } },//SIMA
                    left: { style: 'thin', color: { argb: '000000' } },//ESQUERDA
                    bottom: { style: 'thin', color: { argb: '000000' } },//BAIXO
                    right: { style: 'thin', color: { argb: 'FFFFFF' } } //DIREITA
                }
            };

            /* ---------- APLICANDO EM UMA CÉLULA ESPECÍFICA ---------- */
            // linha 1 
            ['A', 'B', 'C', 'D', 'E', 'H'].forEach(col =>
                Object.assign(ws.getCell(`${col}1`).style, bordaPretaFUNDO)
            );

            // linha 2
            ['B', 'C', 'D', 'E', 'H'].forEach(col =>
                Object.assign(ws.getCell(`${col}2`).style, bordaPretaFUNDO)
            );

            // lInha 3
            ['B', 'C', 'D', 'E', 'H'].forEach(col =>
                Object.assign(ws.getCell(`${col}3`).style, bordaPretaFUNDO)
            );

            // linha 4
            ['B', 'C', 'D', 'E', 'F', 'H'].forEach(col =>
                Object.assign(ws.getCell(`${col}4`).style, bordaPretaTOPO_FUNDO)
            );

            // linha 5
            ['B', 'C', 'D', 'E', 'F', 'H'].forEach(col =>
                Object.assign(ws.getCell(`${col}5`).style, bordaPretaTOPO_FUNDO)
            );

            ['A', 'B', 'C', 'D', 'E', 'H'].forEach(col =>
                Object.assign(ws.getCell(`${col}11`).style, bordaPretaFUNDOd)
            );

            // linha 39
            ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'].forEach(col =>
                Object.assign(ws.getCell(`${col}39`).style, bordaPretaFUNDOce)
            );

            // linha 41
            ['C', 'D', 'E', 'F', 'G'].forEach(col =>
                Object.assign(ws.getCell(`${col}41`).style, bordaPretaCOMPLETO)
            );

            // linha 42
            ['C', 'D', 'E', 'F', 'G'].forEach(col =>
                Object.assign(ws.getCell(`${col}42`).style, bordaPretaCOMPLETO)
            );

            // linha 43
            ['C', 'D', 'E', 'F', 'G'].forEach(col =>
                Object.assign(ws.getCell(`${col}43`).style, bordaPretaCOMPLETO)
            );

            // linha 44
            ['C', 'D', 'E', 'F', 'G'].forEach(col =>
                Object.assign(ws.getCell(`${col}44`).style, bordaPretaCOMPLETO)
            );

            // linha 45
            ['C', 'D', 'E', 'F', 'G'].forEach(col =>
                Object.assign(ws.getCell(`${col}45`).style, bordaPretaCOMPLETO)
            );


            Object.assign(ws.getCell('A2').style, bordaPretaCOMPLETO);
            Object.assign(ws.getCell('A3').style, bordaPretaCOMPLETO);
            Object.assign(ws.getCell('A4').style, bordaPretaCOMPLETO);
            Object.assign(ws.getCell('A5').style, bordaPretaCOMPLETO);

            Object.assign(ws.getCell('B41').style, bordaPretaCOMPLETO);
            Object.assign(ws.getCell('B42').style, bordaPretaCOMPLETO);
            Object.assign(ws.getCell('B43').style, bordaPretaCOMPLETO);
            Object.assign(ws.getCell('B44').style, bordaPretaCOMPLETO);
            Object.assign(ws.getCell('B45').style, bordaPretaCOMPLETO);

            Object.assign(ws.getCell('F2').style, bordaPretaFINAL_ESQUERDA);

            Object.assign(ws.getCell('G5').style, bordaPretaCOMPLETO);
            Object.assign(ws.getCell('G4').style, bordaPretaCOMPLETO);
            Object.assign(ws.getCell('G2').style, bordaPretaFINAL_DIREITA);
            Object.assign(ws.getCell('G41').style, bordaPretaFINAL_ESQUERDA);
            Object.assign(ws.getCell('G42').style, bordaPretaFINAL_ESQUERDA);
            Object.assign(ws.getCell('G43').style, bordaPretaFINAL_ESQUERDA);
            Object.assign(ws.getCell('G44').style, bordaPretaFINAL_ESQUERDA);
            Object.assign(ws.getCell('G45').style, bordaPretaFINAL_ESQUERDA);

            Object.assign(ws.getCell('H41').style, bordaPretaFINAL_DIREITA);
            Object.assign(ws.getCell('H42').style, bordaPretaFINAL_DIREITA);
            Object.assign(ws.getCell('H43').style, bordaPretaFINAL_DIREITA);
            Object.assign(ws.getCell('H44').style, bordaPretaFINAL_DIREITA);
            Object.assign(ws.getCell('H45').style, bordaPretaFINAL_DIREITA);

            Object.assign(ws.getCell('I2').style, bordaPretaFINAL_DIREITA)
            Object.assign(ws.getCell('I3').style, bordaPretaFINAL_DIREITA)
            Object.assign(ws.getCell('I4').style, bordaPretaFINAL_DIREITA)
            Object.assign(ws.getCell('I5').style, bordaPretaFINAL_DIREITA)

            /* ---------- SALVA O ARQUIVO ---------- */
            const buffer = await wb.xlsx.writeBuffer();
            const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
            saveAs(blob, `ORCAMENTO_${cliente.nome.replace(/\s+/g, '_')}.xlsx`);
        }

        /* ----------  IMPORTAÇÃO EXATA – CLIENTE + PRODUTOS  ---------- */
        async function importarExcelOtimizado(file) {
            showLoading(true);

            try {
                const workbook = XLSX.read(await file.arrayBuffer(), { type: 'array', cellFormula: false, cellStyles: false });
                const rows = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]], { header: 1, defval: '' });

                /* ----------  LEITURA DOS CAMPOS DO CLIENTE (completa e flexível) ---------- */
                // ✅ Lê o cabeçalho simples da linha 100
                const cliente = {
                    nome: String(rows[99]?.[1] || '').trim(),
                    endereco: String(rows[100]?.[1] || '').trim(),
                    telefone: String(rows[101]?.[1] || '').trim(),
                    data: String(rows[102]?.[1] || '').trim(),
                    servico: String(rows[103]?.[1] || '').trim(),
                    funcionario: String(rows[104]?.[1] || '').trim(),
                    numero: String(rows[105]?.[1] || '').trim()
                };
                // Procura por padrões mais flexíveis de campos do cliente
                rows.forEach((ln, index) => {
                    if (!ln || !Array.isArray(ln)) return;

                    const linhaTexto = ln.join(' ').toUpperCase();

                    // Procura nome do cliente
                    if (linhaTexto.includes('CLIENTE') || linhaTexto.includes('NOME')) {
                        cliente.nome = String(ln[1] || ln[2] || '').trim();
                    }

                    // Procura endereço
                    if (linhaTexto.includes('ENDEREÇO') || linhaTexto.includes('END.')) {
                        cliente.endereco = String(ln[1] || ln[2] || '').trim();
                    }

                    // Procura telefone
                    if (linhaTexto.includes('TELEFONE') || linhaTexto.includes('TEL.') || linhaTexto.includes('CELULAR')) {
                        cliente.telefone = String(ln[1] || ln[2] || '').trim();
                    }

                    // Procura data
                    if (linhaTexto.includes('DATA') || linhaTexto.includes('DIA') || linhaTexto.includes('EMISSÃO')) {
                        cliente.data = String(ln[1] || ln[2] || '').trim();
                    }

                    // Procura serviço
                    if (linhaTexto.includes('SERVIÇO') || linhaTexto.includes('DESCRIÇÃO') || linhaTexto.includes('TIPO')) {
                        cliente.servico = String(ln[1] || ln[2] || '').trim();
                    }

                    // Procura funcionário
                    if (linhaTexto.includes('FUNCIONÁRIO') || linhaTexto.includes('RESPONSÁVEL') ||
                        linhaTexto.includes('ATENDENTE') || linhaTexto.includes('VENDEDOR')) {
                        cliente.funcionario = String(ln[1] || ln[2] || '').trim();
                    }

                    // Procura número do orçamento
                    if (linhaTexto.includes('NOTA') || linhaTexto.includes('Nº') ||
                        linhaTexto.includes('NÚMERO') || linhaTexto.includes('ORÇAMENTO')) {
                        cliente.numero = String(ln[1] || ln[2] || '').trim();
                    }
                });

                /* ----------  APLICA NO FORMULÁRIO (COM GARANTIA) ---------- */
                function aplicarClienteNosCampos(dados) {
                    const campos = ['nome', 'endereco', 'telefone', 'data', 'servico', 'funcionario', 'numero'];
                    campos.forEach(campo => {
                        const elCliente = document.getElementById(`cliente_${campo}`);
                        const elOrc = document.getElementById(`orc_cliente_${campo}`);
                        if (elCliente) elCliente.value = dados[campo] || '';
                        if (elOrc) elOrc.value = dados[campo] || '';
                    });
                }

                // Garante que a página CLIENTE esteja ativa
                mudarPagina(0);

                // Aguarda o DOM estar pronto e aplica os dados
                let tentativas = 0;
                const intervalo = setInterval(() => {
                    const nomeInput = document.getElementById('cliente_nome');
                    if (nomeInput) {
                        aplicarClienteNosCampos(cliente);
                        clearInterval(intervalo);
                        console.log('✅ Dados do cliente aplicados:', cliente);
                    } else {
                        tentativas++;
                        if (tentativas > 50) {
                            clearInterval(intervalo);
                            console.warn('⚠️ Campos de cliente não encontrados após 50 tentativas.');
                        }
                    }
                }, 100);

                /* ----------  LEITURA DOS PRODUTOS ---------- */
                let iniProd = rows.findIndex(ln => {
                    const texto = String(ln[0] || '').toUpperCase();
                    return texto.includes('COD') || texto.includes('CÓDIGO') || texto.includes('PRODUTO');
                }) + 1;

                if (iniProd === 0) iniProd = 9; // fallback

                const produtos = [];
                for (let i = iniProd; i < rows.length; i++) {
                    const row = rows[i];
                    if (!row || row.length < 3) continue;

                    const cod = String(row[0] || '').trim();
                    const nome = String(row[1] || '').trim();
                    const unid = String(row[2] || '').trim() || 'UNID';
                    const comp = parseFloat(row[3]) || 0;
                    const alt = parseFloat(row[4]) || 0;
                    const qtd = parseFloat(row[5]) || 0;
                    const valor = String(row[6] || '').replace(',', '.');

                    if (qtd > 0 && cod) {
                        produtos.push({
                            codigo: cod,
                            nome: nome,
                            unid: unid,
                            L: alt, // Largura
                            C: comp, // Comprimento
                            Q: qtd,
                            valorTotal: parseFloat(valor) || 0
                        });
                    }
                }

                /* ----------  APLICA PRODUTOS ---------- */
                await aplicarProdutosEmLote(produtos);

                setTimeout(() => {
                    calcularValores();
                    atualizarOrcamento();
                    sincronizarClienteParaOrcamentoGarantido();
                    showLoading(false);
                    showNotification('Importação concluída com sucesso!', 'success');
                    mudarPagina(0);
                }, 300);

            } catch (e) {
                showLoading(false);
                console.error(e);
                showNotification('Erro ao importar: ' + e.message, 'error');
            }
        }

        function sincronizarClienteParaOrcamentoGarantido() {
            const campos = ["nome", "endereco", "telefone", "data", "servico", "funcionario", "numero"];
            let sincronizados = 0;

            campos.forEach(campo => {
                const origem = document.getElementById(`cliente_${campo}`);
                const destino = document.getElementById(`orc_cliente_${campo}`);

                if (origem && destino && origem.value) {
                    destino.value = origem.value;
                    sincronizados++;
                    console.log(`🔄 Sincronizado ${campo}: ${origem.value}`);
                }
            });

            console.log(`✅ ${sincronizados} campos sincronizados`);
            return sincronizados;
        }

        async function aplicarProdutosEmLote(produtos) {
            const batchSize = 50;
            for (let i = 0; i < produtos.length; i += batchSize) {
                const batch = produtos.slice(i, i + batchSize);
                batch.forEach(p => aplicarProdutoNaTabela(p));
                await new Promise(resolve => requestIdleCallback(resolve));
            }
        }

        function aplicarProdutoNaTabela({ codigo, nome, L, C, Q, unidade, precoBase, valorTotal }) {
            console.log(`🔍 Aplicando produto: ${codigo} | Q=${Q}, L=${L}, C=${C}`);

            // 🔍 Busca TODAS as linhas de TODAS as tabelas
            const todasLinhas = Array.from(document.querySelectorAll('.planilha tbody tr'));

            // 🔍 Filtra apenas as que têm o código correto
            const linhasComCodigo = todasLinhas.filter(tr => {
                const codigoCelula = tr.cells[1]?.textContent?.trim();
                return codigoCelula === codigo;
            });

            console.log(`📦 Linhas encontradas com código ${codigo}:`, linhasComCodigo.length);

            if (linhasComCodigo.length === 0) {
                console.warn(`⚠️ Nenhuma linha encontrada com código: ${codigo}`);
                return;
            }

            // 🔍 Tenta encontrar uma linha vazia (quantidade = 0)
            let linhaDisponivel = linhasComCodigo.find(tr => {
                const qtd = parseFloat(tr.querySelector('.quantidade')?.value) || 0;
                return qtd === 0;
            });

            // 🔥 Se não houver linha vazia, clona a última
            if (!linhaDisponivel) {
                const ultima = linhasComCodigo[linhasComCodigo.length - 1];
                console.log(`🧬 Clonando linha para ${codigo}`);
                clonarLinha(ultima.querySelector('.btn-clone'));
                linhaDisponivel = ultima.nextElementSibling;
            }

            if (!linhaDisponivel) {
                console.error(`❌ Falha ao obter linha disponível para ${codigo}`);
                return;
            }

            // ✅ Preenche a linha
            linhaDisponivel.querySelector('.largura').value = L;
            linhaDisponivel.querySelector('.comprimento').value = C;
            linhaDisponivel.querySelector('.quantidade').value = Q;

            console.log(`✅ Produto ${codigo} aplicado com sucesso.`);
        }
        // ======= BOTÃO CLONAR =======
        function clonarLinha(btn) {
            const linhaOriginal = btn.closest('tr');
            const clone = linhaOriginal.cloneNode(true);

            clone.querySelectorAll('input').forEach(inp => {
                inp.value = 0;
                inp.dispatchEvent(new Event('input'));
            });

            clone.querySelector('.valor-total').textContent = '0,00';

            linhaOriginal.after(clone);
            monitorarInputs();

            showNotification('Produto clonado com sucesso!', 'info');
        }

        // ======= LOADING =======
        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'flex' : 'none';
        }

        // ======= EVENTOS =======
        document.addEventListener("input", e => {
            if (e.target.id && e.target.id.startsWith("cliente_")) {
                sincronizarClienteParaOrcamento();
            }
        });

        document.addEventListener("click", e => {
            if (e.target.classList.contains("clicavel")) {
                e.target.textContent = e.target.textContent === "X" ? "" : "X";
            }
        });

        // Fechar modais ao clicar fora
        window.addEventListener("click", e => {
            if (e.target.classList.contains("modal")) {
                e.target.style.display = "none";
            }
        });

        // ======= INICIALIZAÇÃO =======
        window.addEventListener("DOMContentLoaded", () => {
            initializeInterface();

            // Adiciona efeitos de entrada
            setTimeout(() => {
                document.body.classList.add('fade-in');
            }, 100);
        });

        // ======= ATALHOS DE TECLADO =======
        document.addEventListener('keydown', e => {
            // Ctrl + S para salvar
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                salvarOrcamentoLocal();
            }

            // Ctrl + O para abrir
            if (e.ctrlKey && e.key === 'o') {
                e.preventDefault();
                carregarOrcamentoDeArquivo();
            }

            // Ctrl + B para biblioteca
            if (e.ctrlKey && e.key === 'b') {
                e.preventDefault();
                showBiblioteca();
            }

            // Ctrl + N para novo produto
            if (e.ctrlKey && e.key === 'n') {
                e.preventDefault();
                showAddProductModal();
            }
        });

        document.addEventListener("input", e => {
            if (e.target.id && e.target.id.startsWith("cliente_")) {
                // Sincroniza imediatamente
                sincronizarClienteParaOrcamento();

                // Garante sincronização após um pequeno delay
                setTimeout(() => {
                    sincronizarClienteParaOrcamentoGarantido();
                }, 100);
            }
        });


    </script>

    <script>
  document.getElementById('btnInstrucoes').addEventListener('click', function () {
    const querSair = confirm(
      'Atenção!\n' +
      'Ao mudar para a página de instruções você PERDERÁ o orçamento que não foi salvo.\n\n' +
      'Deseja realmente sair?'
    );

    if (querSair) {
      window.location.href = 'instrucoes.html';
    }
  });
</script>


</body>

</html>